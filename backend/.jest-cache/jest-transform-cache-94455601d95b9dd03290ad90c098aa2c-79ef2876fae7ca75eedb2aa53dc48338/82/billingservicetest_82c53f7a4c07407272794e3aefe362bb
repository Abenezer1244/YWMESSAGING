bb8ad2f874a5aa59ab4614332f325b5e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const mockChurch = {
    id: 'church-1',
    name: 'Grace Community Church',
    plan: 'professional',
    stripeCustomerId: 'cus_test123',
};
const mockBillingData = {
    churchId: 'church-1',
    monthlyContacts: 1500,
    monthlyMessages: 50,
    monthlyPrice: 99.99,
    planLimits: {
        contacts: 5000,
        messagesPerMonth: 1000,
        storageGb: 50,
    },
};
(0, globals_1.describe)('Billing Service', () => {
    (0, globals_1.describe)('Plan Validation', () => {
        (0, globals_1.it)('should validate plan types', () => {
            const validPlans = ['free', 'starter', 'professional', 'enterprise'];
            const invalidPlan = 'unknown';
            (0, globals_1.expect)(validPlans.includes('professional')).toBe(true);
            (0, globals_1.expect)(validPlans.includes(invalidPlan)).toBe(false);
        });
        (0, globals_1.it)('should retrieve correct plan limits', () => {
            const plans = {
                free: { contacts: 100, messagesPerMonth: 10 },
                starter: { contacts: 500, messagesPerMonth: 100 },
                professional: { contacts: 5000, messagesPerMonth: 1000 },
            };
            (0, globals_1.expect)(plans['professional'].contacts).toBe(5000);
            (0, globals_1.expect)(plans['professional'].messagesPerMonth).toBe(1000);
        });
        (0, globals_1.it)('should escalate limits for higher tiers', () => {
            const contactLimits = {
                free: 100,
                starter: 500,
                professional: 5000,
                enterprise: 50000,
            };
            (0, globals_1.expect)(contactLimits.free).toBeLessThan(contactLimits.starter);
            (0, globals_1.expect)(contactLimits.starter).toBeLessThan(contactLimits.professional);
            (0, globals_1.expect)(contactLimits.professional).toBeLessThan(contactLimits.enterprise);
        });
    });
    (0, globals_1.describe)('Usage Tracking', () => {
        (0, globals_1.it)('should track monthly contact count', () => {
            const usage = {
                churchId: 'church-1',
                month: 'December',
                contactsUsed: 1500,
                contactsLimit: 5000,
            };
            (0, globals_1.expect)(usage.contactsUsed).toBeLessThan(usage.contactsLimit);
        });
        (0, globals_1.it)('should track monthly message count', () => {
            const usage = {
                churchId: 'church-1',
                month: 'December',
                messagesUsed: 450,
                messagesLimit: 1000,
            };
            (0, globals_1.expect)(usage.messagesUsed).toBeLessThan(usage.messagesLimit);
        });
        (0, globals_1.it)('should alert when approaching limits (90%)', () => {
            const usage = {
                contactsUsed: 4800,
                contactsLimit: 5000,
                percentageUsed: (4800 / 5000) * 100,
            };
            (0, globals_1.expect)(usage.percentageUsed).toBeGreaterThan(90);
        });
        (0, globals_1.it)('should calculate percentage usage correctly', () => {
            const usage = {
                used: 50,
                limit: 100,
                percentage: (50 / 100) * 100,
            };
            (0, globals_1.expect)(usage.percentage).toBe(50);
        });
    });
    (0, globals_1.describe)('Overage Calculations', () => {
        (0, globals_1.it)('should calculate overages correctly', () => {
            const usage = 5100;
            const limit = 5000;
            const overageAmount = usage - limit;
            const overageCharge = overageAmount * 0.10; // $0.10 per overage contact
            (0, globals_1.expect)(overageAmount).toBe(100);
            (0, globals_1.expect)(overageCharge).toBe(10);
        });
        (0, globals_1.it)('should apply overage only when exceeding limit', () => {
            const withinLimit = { used: 4500, limit: 5000 };
            const exceedingLimit = { used: 5500, limit: 5000 };
            (0, globals_1.expect)(withinLimit.used).toBeLessThanOrEqual(withinLimit.limit);
            (0, globals_1.expect)(exceedingLimit.used).toBeGreaterThan(exceedingLimit.limit);
        });
        (0, globals_1.it)('should not charge overage when under limit', () => {
            const usage = { used: 4000, limit: 5000 };
            const overage = Math.max(0, usage.used - usage.limit);
            (0, globals_1.expect)(overage).toBe(0);
        });
        (0, globals_1.it)('should cap total charges at monthly maximum', () => {
            const basePlan = 99.99;
            const maxOverage = 500; // Cap at $500/month
            const totalCharge = Math.min(basePlan + maxOverage, basePlan + maxOverage);
            (0, globals_1.expect)(totalCharge).toBeLessThanOrEqual(basePlan + maxOverage);
        });
    });
    (0, globals_1.describe)('Payment Processing', () => {
        (0, globals_1.it)('should validate card number format', () => {
            const cardNumber = '4242424242424242';
            const isValidLength = cardNumber.length === 16;
            const isNumeric = /^\d+$/.test(cardNumber);
            (0, globals_1.expect)(isValidLength).toBe(true);
            (0, globals_1.expect)(isNumeric).toBe(true);
        });
        (0, globals_1.it)('should require valid Stripe customer ID', () => {
            const validStripeId = 'cus_test123';
            const invalidStripeId = 'invalid';
            (0, globals_1.expect)(validStripeId).toMatch(/^cus_/);
            (0, globals_1.expect)(invalidStripeId).not.toMatch(/^cus_/);
        });
        (0, globals_1.it)('should track payment status', () => {
            const paymentStatuses = ['pending', 'processing', 'succeeded', 'failed'];
            const validStatus = 'succeeded';
            (0, globals_1.expect)(paymentStatuses.includes(validStatus)).toBe(true);
        });
        (0, globals_1.it)('should prevent duplicate charges', () => {
            const charges = [
                { id: 'charge-1', amount: 99.99, status: 'succeeded' },
                { id: 'charge-1', amount: 99.99, status: 'succeeded' },
            ];
            const uniqueCharges = [...new Set(charges.map(c => c.id))];
            (0, globals_1.expect)(uniqueCharges.length).toBe(1);
        });
    });
    (0, globals_1.describe)('Trial Management', () => {
        (0, globals_1.it)('should track trial start and end dates', () => {
            const trial = {
                churchId: 'church-1',
                startDate: new Date('2025-12-01'),
                endDate: new Date('2025-12-31'),
                daysRemaining: 30,
            };
            (0, globals_1.expect)(trial.startDate).toBeTruthy();
            (0, globals_1.expect)(trial.endDate.getTime()).toBeGreaterThan(trial.startDate.getTime());
            (0, globals_1.expect)(trial.daysRemaining).toBeGreaterThan(0);
        });
        (0, globals_1.it)('should prevent actions after trial expires', () => {
            const today = new Date('2025-12-15');
            const expiredTrial = {
                endDate: new Date('2025-12-14'),
                isExpired: today > new Date('2025-12-14'),
            };
            (0, globals_1.expect)(expiredTrial.isExpired).toBe(true);
        });
        (0, globals_1.it)('should enforce payment before conversion from trial', () => {
            const conversion = {
                requiresPayment: true,
                trialEnded: true,
                planSelected: 'professional',
            };
            (0, globals_1.expect)(conversion.requiresPayment).toBe(true);
            (0, globals_1.expect)(conversion.trialEnded).toBe(true);
        });
        (0, globals_1.it)('should set trial duration to 14 days by default', () => {
            const startDate = new Date('2025-12-01');
            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + 14);
            const durationDays = Math.floor((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));
            (0, globals_1.expect)(durationDays).toBe(14);
        });
    });
    (0, globals_1.describe)('Invoice Generation', () => {
        (0, globals_1.it)('should generate invoice with all required fields', () => {
            const invoice = {
                id: 'inv-001',
                churchId: 'church-1',
                date: new Date(),
                amount: 99.99,
                status: 'paid',
                items: [
                    { description: 'Professional Plan', amount: 79.99 },
                    { description: 'Overage (100 contacts)', amount: 20.00 },
                ],
            };
            (0, globals_1.expect)(invoice.id).toBeTruthy();
            (0, globals_1.expect)(invoice.amount).toBeGreaterThan(0);
            (0, globals_1.expect)(invoice.items.length).toBeGreaterThan(0);
            (0, globals_1.expect)(invoice.status).toBe('paid');
        });
        (0, globals_1.it)('should total invoice items correctly', () => {
            const items = [
                { description: 'Plan', amount: 79.99 },
                { description: 'Overage', amount: 20.00 },
            ];
            const total = items.reduce((sum, item) => sum + item.amount, 0);
            (0, globals_1.expect)(total).toBeCloseTo(99.99, 2);
        });
        (0, globals_1.it)('should track invoice payment status', () => {
            const validStatuses = ['pending', 'paid', 'failed', 'refunded'];
            const invoice = { status: 'paid' };
            (0, globals_1.expect)(validStatuses.includes(invoice.status)).toBe(true);
        });
        (0, globals_1.it)('should store invoice PDF URL', () => {
            const invoice = {
                id: 'inv-001',
                pdfUrl: 'https://invoices.example.com/inv-001.pdf',
            };
            (0, globals_1.expect)(invoice.pdfUrl).toMatch(/https:\/\//);
            (0, globals_1.expect)(invoice.pdfUrl).toContain(invoice.id);
        });
    });
    (0, globals_1.describe)('Multi-tenancy in Billing', () => {
        (0, globals_1.it)('should isolate billing by churchId', () => {
            const billing1 = { churchId: 'church-1', amount: 99.99 };
            const billing2 = { churchId: 'church-2', amount: 199.99 };
            (0, globals_1.expect)(billing1.churchId).not.toBe(billing2.churchId);
            (0, globals_1.expect)(billing1.amount).not.toBe(billing2.amount);
        });
        (0, globals_1.it)('should prevent viewing other church invoices', () => {
            const userChurchId = 'church-1';
            const invoiceChurchId = 'church-2';
            (0, globals_1.expect)(userChurchId).not.toBe(invoiceChurchId);
            const canAccess = userChurchId === invoiceChurchId;
            (0, globals_1.expect)(canAccess).toBe(false);
        });
        (0, globals_1.it)('should enforce church isolation in billing updates', () => {
            const church1BillingEmail = 'billing@church1.com';
            const church2BillingEmail = 'billing@church2.com';
            (0, globals_1.expect)(church1BillingEmail).not.toBe(church2BillingEmail);
        });
    });
    (0, globals_1.describe)('Refund Handling', () => {
        (0, globals_1.it)('should track refund requests', () => {
            const refund = {
                id: 'refund-001',
                chargeId: 'charge-123',
                amount: 99.99,
                reason: 'Billing error',
                status: 'pending',
            };
            (0, globals_1.expect)(refund.status).toBe('pending');
            (0, globals_1.expect)(refund.amount).toBeGreaterThan(0);
        });
        (0, globals_1.it)('should allow refunds within 30 days', () => {
            const chargeDate = new Date('2025-11-01');
            const refundDate = new Date('2025-11-30');
            const daysElapsed = Math.floor((refundDate.getTime() - chargeDate.getTime()) / (1000 * 60 * 60 * 24));
            (0, globals_1.expect)(daysElapsed).toBeLessThanOrEqual(30);
        });
        (0, globals_1.it)('should prevent refunds older than 30 days', () => {
            const chargeDate = new Date('2025-10-01');
            const refundDate = new Date('2025-12-01');
            const daysElapsed = Math.floor((refundDate.getTime() - chargeDate.getTime()) / (1000 * 60 * 60 * 24));
            (0, globals_1.expect)(daysElapsed).toBeGreaterThan(30);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxXaW5kb3dzXFxPbmVEcml2ZSAtIFNlYXR0bGUgQ29sbGVnZXNcXERlc2t0b3BcXFlXTUVTU0FHSU5HXFxiYWNrZW5kXFxzcmNcXF9fdGVzdHNfX1xcc2VydmljZXNcXGJpbGxpbmcuc2VydmljZS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsMkNBQXFEO0FBRXJELE1BQU0sVUFBVSxHQUFHO0lBQ2pCLEVBQUUsRUFBRSxVQUFVO0lBQ2QsSUFBSSxFQUFFLHdCQUF3QjtJQUM5QixJQUFJLEVBQUUsY0FBYztJQUNwQixnQkFBZ0IsRUFBRSxhQUFhO0NBQ2hDLENBQUM7QUFFRixNQUFNLGVBQWUsR0FBRztJQUN0QixRQUFRLEVBQUUsVUFBVTtJQUNwQixlQUFlLEVBQUUsSUFBSTtJQUNyQixlQUFlLEVBQUUsRUFBRTtJQUNuQixZQUFZLEVBQUUsS0FBSztJQUNuQixVQUFVLEVBQUU7UUFDVixRQUFRLEVBQUUsSUFBSTtRQUNkLGdCQUFnQixFQUFFLElBQUk7UUFDdEIsU0FBUyxFQUFFLEVBQUU7S0FDZDtDQUNGLENBQUM7QUFFRixJQUFBLGtCQUFRLEVBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO0lBQy9CLElBQUEsa0JBQVEsRUFBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsSUFBQSxZQUFFLEVBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1lBQ3BDLE1BQU0sVUFBVSxHQUFHLENBQUMsTUFBTSxFQUFFLFNBQVMsRUFBRSxjQUFjLEVBQUUsWUFBWSxDQUFDLENBQUM7WUFDckUsTUFBTSxXQUFXLEdBQUcsU0FBUyxDQUFDO1lBRTlCLElBQUEsZ0JBQU0sRUFBQyxVQUFVLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3ZELElBQUEsZ0JBQU0sRUFBQyxVQUFVLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZELENBQUMs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Q0FBQyxVQUFVLENBQUMsT0FBTyxFQUFFLEdBQUcsVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRXRHLElBQUEsZ0JBQU0sRUFBQyxXQUFXLENBQUMsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcV2luZG93c1xcT25lRHJpdmUgLSBTZWF0dGxlIENvbGxlZ2VzXFxEZXNrdG9wXFxZV01FU1NBR0lOR1xcYmFja2VuZFxcc3JjXFxfX3Rlc3RzX19cXHNlcnZpY2VzXFxiaWxsaW5nLnNlcnZpY2UudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuXG5jb25zdCBtb2NrQ2h1cmNoID0ge1xuICBpZDogJ2NodXJjaC0xJyxcbiAgbmFtZTogJ0dyYWNlIENvbW11bml0eSBDaHVyY2gnLFxuICBwbGFuOiAncHJvZmVzc2lvbmFsJyxcbiAgc3RyaXBlQ3VzdG9tZXJJZDogJ2N1c190ZXN0MTIzJyxcbn07XG5cbmNvbnN0IG1vY2tCaWxsaW5nRGF0YSA9IHtcbiAgY2h1cmNoSWQ6ICdjaHVyY2gtMScsXG4gIG1vbnRobHlDb250YWN0czogMTUwMCxcbiAgbW9udGhseU1lc3NhZ2VzOiA1MCxcbiAgbW9udGhseVByaWNlOiA5OS45OSxcbiAgcGxhbkxpbWl0czoge1xuICAgIGNvbnRhY3RzOiA1MDAwLFxuICAgIG1lc3NhZ2VzUGVyTW9udGg6IDEwMDAsXG4gICAgc3RvcmFnZUdiOiA1MCxcbiAgfSxcbn07XG5cbmRlc2NyaWJlKCdCaWxsaW5nIFNlcnZpY2UnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdQbGFuIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBwbGFuIHR5cGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRQbGFucyA9IFsnZnJlZScsICdzdGFydGVyJywgJ3Byb2Zlc3Npb25hbCcsICdlbnRlcnByaXNlJ107XG4gICAgICBjb25zdCBpbnZhbGlkUGxhbiA9ICd1bmtub3duJztcblxuICAgICAgZXhwZWN0KHZhbGlkUGxhbnMuaW5jbHVkZXMoJ3Byb2Zlc3Npb25hbCcpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHZhbGlkUGxhbnMuaW5jbHVkZXMoaW52YWxpZFBsYW4pKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0cmlldmUgY29ycmVjdCBwbGFuIGxpbWl0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IHBsYW5zID0ge1xuICAgICAgICBmcmVlOiB7IGNvbnRhY3RzOiAxMDAsIG1lc3NhZ2VzUGVyTW9udGg6IDEwIH0sXG4gICAgICAgIHN0YXJ0ZXI6IHsgY29udGFjdHM6IDUwMCwgbWVzc2FnZXNQZXJNb250aDogMTAwIH0sXG4gICAgICAgIHByb2Zlc3Npb25hbDogeyBjb250YWN0czogNTAwMCwgbWVzc2FnZXNQZXJNb250aDogMTAwMCB9LFxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KHBsYW5zWydwcm9mZXNzaW9uYWwnXS5jb250YWN0cykudG9CZSg1MDAwKTtcbiAgICAgIGV4cGVjdChwbGFuc1sncHJvZmVzc2lvbmFsJ10ubWVzc2FnZXNQZXJNb250aCkudG9CZSgxMDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXNjYWxhdGUgbGltaXRzIGZvciBoaWdoZXIgdGllcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb250YWN0TGltaXRzOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9ID0ge1xuICAgICAgICBmcmVlOiAxMDAsXG4gICAgICAgIHN0YXJ0ZXI6IDUwMCxcbiAgICAgICAgcHJvZmVzc2lvbmFsOiA1MDAwLFxuICAgICAgICBlbnRlcnByaXNlOiA1MDAwMCxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChjb250YWN0TGltaXRzLmZyZWUpLnRvQmVMZXNzVGhhbihjb250YWN0TGltaXRzLnN0YXJ0ZXIpO1xuICAgICAgZXhwZWN0KGNvbnRhY3RMaW1pdHMuc3RhcnRlcikudG9CZUxlc3NUaGFuKGNvbnRhY3RMaW1pdHMucHJvZmVzc2lvbmFsKTtcbiAgICAgIGV4cGVjdChjb250YWN0TGltaXRzLnByb2Zlc3Npb25hbCkudG9CZUxlc3NUaGFuKGNvbnRhY3RMaW1pdHMuZW50ZXJwcmlzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVc2FnZSBUcmFja2luZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRyYWNrIG1vbnRobHkgY29udGFjdCBjb3VudCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHVzYWdlID0ge1xuICAgICAgICBjaHVyY2hJZDogJ2NodXJjaC0xJyxcbiAgICAgICAgbW9udGg6ICdEZWNlbWJlcicsXG4gICAgICAgIGNvbnRhY3RzVXNlZDogMTUwMCxcbiAgICAgICAgY29udGFjdHNMaW1pdDogNTAwMCxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdCh1c2FnZS5jb250YWN0c1VzZWQpLnRvQmVMZXNzVGhhbih1c2FnZS5jb250YWN0c0xpbWl0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdHJhY2sgbW9udGhseSBtZXNzYWdlIGNvdW50JywgKCkgPT4ge1xuICAgICAgY29uc3QgdXNhZ2UgPSB7XG4gICAgICAgIGNodXJjaElkOiAnY2h1cmNoLTEnLFxuICAgICAgICBtb250aDogJ0RlY2VtYmVyJyxcbiAgICAgICAgbWVzc2FnZXNVc2VkOiA0NTAsXG4gICAgICAgIG1lc3NhZ2VzTGltaXQ6IDEwMDAsXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QodXNhZ2UubWVzc2FnZXNVc2VkKS50b0JlTGVzc1RoYW4odXNhZ2UubWVzc2FnZXNMaW1pdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsZXJ0IHdoZW4gYXBwcm9hY2hpbmcgbGltaXRzICg5MCUpJywgKCkgPT4ge1xuICAgICAgY29uc3QgdXNhZ2UgPSB7XG4gICAgICAgIGNvbnRhY3RzVXNlZDogNDgwMCxcbiAgICAgICAgY29udGFjdHNMaW1pdDogNTAwMCxcbiAgICAgICAgcGVyY2VudGFnZVVzZWQ6ICg0ODAwIC8gNTAwMCkgKiAxMDAsXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QodXNhZ2UucGVyY2VudGFnZVVzZWQpLnRvQmVHcmVhdGVyVGhhbig5MCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSBwZXJjZW50YWdlIHVzYWdlIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHVzYWdlID0ge1xuICAgICAgICB1c2VkOiA1MCxcbiAgICAgICAgbGltaXQ6IDEwMCxcbiAgICAgICAgcGVyY2VudGFnZTogKDUwIC8gMTAwKSAqIDEwMCxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdCh1c2FnZS5wZXJjZW50YWdlKS50b0JlKDUwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ092ZXJhZ2UgQ2FsY3VsYXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIG92ZXJhZ2VzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHVzYWdlID0gNTEwMDtcbiAgICAgIGNvbnN0IGxpbWl0ID0gNTAwMDtcbiAgICAgIGNvbnN0IG92ZXJhZ2VBbW91bnQgPSB1c2FnZSAtIGxpbWl0O1xuICAgICAgY29uc3Qgb3ZlcmFnZUNoYXJnZSA9IG92ZXJhZ2VBbW91bnQgKiAwLjEwOyAvLyAkMC4xMCBwZXIgb3ZlcmFnZSBjb250YWN0XG5cbiAgICAgIGV4cGVjdChvdmVyYWdlQW1vdW50KS50b0JlKDEwMCk7XG4gICAgICBleHBlY3Qob3ZlcmFnZUNoYXJnZSkudG9CZSgxMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFwcGx5IG92ZXJhZ2Ugb25seSB3aGVuIGV4Y2VlZGluZyBsaW1pdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHdpdGhpbkxpbWl0ID0geyB1c2VkOiA0NTAwLCBsaW1pdDogNTAwMCB9O1xuICAgICAgY29uc3QgZXhjZWVkaW5nTGltaXQgPSB7IHVzZWQ6IDU1MDAsIGxpbWl0OiA1MDAwIH07XG5cbiAgICAgIGV4cGVjdCh3aXRoaW5MaW1pdC51c2VkKS50b0JlTGVzc1RoYW5PckVxdWFsKHdpdGhpbkxpbWl0LmxpbWl0KTtcbiAgICAgIGV4cGVjdChleGNlZWRpbmdMaW1pdC51c2VkKS50b0JlR3JlYXRlclRoYW4oZXhjZWVkaW5nTGltaXQubGltaXQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgY2hhcmdlIG92ZXJhZ2Ugd2hlbiB1bmRlciBsaW1pdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHVzYWdlID0geyB1c2VkOiA0MDAwLCBsaW1pdDogNTAwMCB9O1xuICAgICAgY29uc3Qgb3ZlcmFnZSA9IE1hdGgubWF4KDAsIHVzYWdlLnVzZWQgLSB1c2FnZS5saW1pdCk7XG5cbiAgICAgIGV4cGVjdChvdmVyYWdlKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYXAgdG90YWwgY2hhcmdlcyBhdCBtb250aGx5IG1heGltdW0nLCAoKSA9PiB7XG4gICAgICBjb25zdCBiYXNlUGxhbiA9IDk5Ljk5O1xuICAgICAgY29uc3QgbWF4T3ZlcmFnZSA9IDUwMDsgLy8gQ2FwIGF0ICQ1MDAvbW9udGhcbiAgICAgIGNvbnN0IHRvdGFsQ2hhcmdlID0gTWF0aC5taW4oYmFzZVBsYW4gKyBtYXhPdmVyYWdlLCBiYXNlUGxhbiArIG1heE92ZXJhZ2UpO1xuXG4gICAgICBleHBlY3QodG90YWxDaGFyZ2UpLnRvQmVMZXNzVGhhbk9yRXF1YWwoYmFzZVBsYW4gKyBtYXhPdmVyYWdlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BheW1lbnQgUHJvY2Vzc2luZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNhcmQgbnVtYmVyIGZvcm1hdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGNhcmROdW1iZXIgPSAnNDI0MjQyNDI0MjQyNDI0Mic7XG4gICAgICBjb25zdCBpc1ZhbGlkTGVuZ3RoID0gY2FyZE51bWJlci5sZW5ndGggPT09IDE2O1xuICAgICAgY29uc3QgaXNOdW1lcmljID0gL15cXGQrJC8udGVzdChjYXJkTnVtYmVyKTtcblxuICAgICAgZXhwZWN0KGlzVmFsaWRMZW5ndGgpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNOdW1lcmljKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXF1aXJlIHZhbGlkIFN0cmlwZSBjdXN0b21lciBJRCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkU3RyaXBlSWQgPSAnY3VzX3Rlc3QxMjMnO1xuICAgICAgY29uc3QgaW52YWxpZFN0cmlwZUlkID0gJ2ludmFsaWQnO1xuXG4gICAgICBleHBlY3QodmFsaWRTdHJpcGVJZCkudG9NYXRjaCgvXmN1c18vKTtcbiAgICAgIGV4cGVjdChpbnZhbGlkU3RyaXBlSWQpLm5vdC50b01hdGNoKC9eY3VzXy8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0cmFjayBwYXltZW50IHN0YXR1cycsICgpID0+IHtcbiAgICAgIGNvbnN0IHBheW1lbnRTdGF0dXNlcyA9IFsncGVuZGluZycsICdwcm9jZXNzaW5nJywgJ3N1Y2NlZWRlZCcsICdmYWlsZWQnXTtcbiAgICAgIGNvbnN0IHZhbGlkU3RhdHVzID0gJ3N1Y2NlZWRlZCc7XG5cbiAgICAgIGV4cGVjdChwYXltZW50U3RhdHVzZXMuaW5jbHVkZXModmFsaWRTdGF0dXMpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IGR1cGxpY2F0ZSBjaGFyZ2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2hhcmdlcyA9IFtcbiAgICAgICAgeyBpZDogJ2NoYXJnZS0xJywgYW1vdW50OiA5OS45OSwgc3RhdHVzOiAnc3VjY2VlZGVkJyB9LFxuICAgICAgICB7IGlkOiAnY2hhcmdlLTEnLCBhbW91bnQ6IDk5Ljk5LCBzdGF0dXM6ICdzdWNjZWVkZWQnIH0sXG4gICAgICBdO1xuXG4gICAgICBjb25zdCB1bmlxdWVDaGFyZ2VzID0gWy4uLm5ldyBTZXQoY2hhcmdlcy5tYXAoYyA9PiBjLmlkKSldO1xuICAgICAgZXhwZWN0KHVuaXF1ZUNoYXJnZXMubGVuZ3RoKS50b0JlKDEpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVHJpYWwgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHRyYWNrIHRyaWFsIHN0YXJ0IGFuZCBlbmQgZGF0ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmlhbCA9IHtcbiAgICAgICAgY2h1cmNoSWQ6ICdjaHVyY2gtMScsXG4gICAgICAgIHN0YXJ0RGF0ZTogbmV3IERhdGUoJzIwMjUtMTItMDEnKSxcbiAgICAgICAgZW5kRGF0ZTogbmV3IERhdGUoJzIwMjUtMTItMzEnKSxcbiAgICAgICAgZGF5c1JlbWFpbmluZzogMzAsXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QodHJpYWwuc3RhcnREYXRlKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QodHJpYWwuZW5kRGF0ZS5nZXRUaW1lKCkpLnRvQmVHcmVhdGVyVGhhbih0cmlhbC5zdGFydERhdGUuZ2V0VGltZSgpKTtcbiAgICAgIGV4cGVjdCh0cmlhbC5kYXlzUmVtYWluaW5nKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgYWN0aW9ucyBhZnRlciB0cmlhbCBleHBpcmVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgnMjAyNS0xMi0xNScpO1xuICAgICAgY29uc3QgZXhwaXJlZFRyaWFsID0ge1xuICAgICAgICBlbmREYXRlOiBuZXcgRGF0ZSgnMjAyNS0xMi0xNCcpLFxuICAgICAgICBpc0V4cGlyZWQ6IHRvZGF5ID4gbmV3IERhdGUoJzIwMjUtMTItMTQnKSxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChleHBpcmVkVHJpYWwuaXNFeHBpcmVkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbmZvcmNlIHBheW1lbnQgYmVmb3JlIGNvbnZlcnNpb24gZnJvbSB0cmlhbCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnZlcnNpb24gPSB7XG4gICAgICAgIHJlcXVpcmVzUGF5bWVudDogdHJ1ZSxcbiAgICAgICAgdHJpYWxFbmRlZDogdHJ1ZSxcbiAgICAgICAgcGxhblNlbGVjdGVkOiAncHJvZmVzc2lvbmFsJyxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChjb252ZXJzaW9uLnJlcXVpcmVzUGF5bWVudCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChjb252ZXJzaW9uLnRyaWFsRW5kZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNldCB0cmlhbCBkdXJhdGlvbiB0byAxNCBkYXlzIGJ5IGRlZmF1bHQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZSgnMjAyNS0xMi0wMScpO1xuICAgICAgY29uc3QgZW5kRGF0ZSA9IG5ldyBEYXRlKHN0YXJ0RGF0ZSk7XG4gICAgICBlbmREYXRlLnNldERhdGUoZW5kRGF0ZS5nZXREYXRlKCkgKyAxNCk7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uRGF5cyA9IE1hdGguZmxvb3IoKGVuZERhdGUuZ2V0VGltZSgpIC0gc3RhcnREYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuICAgICAgZXhwZWN0KGR1cmF0aW9uRGF5cykudG9CZSgxNCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnZvaWNlIEdlbmVyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBpbnZvaWNlIHdpdGggYWxsIHJlcXVpcmVkIGZpZWxkcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGludm9pY2UgPSB7XG4gICAgICAgIGlkOiAnaW52LTAwMScsXG4gICAgICAgIGNodXJjaElkOiAnY2h1cmNoLTEnLFxuICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLFxuICAgICAgICBhbW91bnQ6IDk5Ljk5LFxuICAgICAgICBzdGF0dXM6ICdwYWlkJyxcbiAgICAgICAgaXRlbXM6IFtcbiAgICAgICAgICB7IGRlc2NyaXB0aW9uOiAnUHJvZmVzc2lvbmFsIFBsYW4nLCBhbW91bnQ6IDc5Ljk5IH0sXG4gICAgICAgICAgeyBkZXNjcmlwdGlvbjogJ092ZXJhZ2UgKDEwMCBjb250YWN0cyknLCBhbW91bnQ6IDIwLjAwIH0sXG4gICAgICAgIF0sXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QoaW52b2ljZS5pZCkudG9CZVRydXRoeSgpO1xuICAgICAgZXhwZWN0KGludm9pY2UuYW1vdW50KS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QoaW52b2ljZS5pdGVtcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChpbnZvaWNlLnN0YXR1cykudG9CZSgncGFpZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0b3RhbCBpbnZvaWNlIGl0ZW1zIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGl0ZW1zID0gW1xuICAgICAgICB7IGRlc2NyaXB0aW9uOiAnUGxhbicsIGFtb3VudDogNzkuOTkgfSxcbiAgICAgICAgeyBkZXNjcmlwdGlvbjogJ092ZXJhZ2UnLCBhbW91bnQ6IDIwLjAwIH0sXG4gICAgICBdO1xuICAgICAgY29uc3QgdG90YWwgPSBpdGVtcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgaXRlbS5hbW91bnQsIDApO1xuXG4gICAgICBleHBlY3QodG90YWwpLnRvQmVDbG9zZVRvKDk5Ljk5LCAyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdHJhY2sgaW52b2ljZSBwYXltZW50IHN0YXR1cycsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkU3RhdHVzZXMgPSBbJ3BlbmRpbmcnLCAncGFpZCcsICdmYWlsZWQnLCAncmVmdW5kZWQnXTtcbiAgICAgIGNvbnN0IGludm9pY2UgPSB7IHN0YXR1czogJ3BhaWQnIH07XG5cbiAgICAgIGV4cGVjdCh2YWxpZFN0YXR1c2VzLmluY2x1ZGVzKGludm9pY2Uuc3RhdHVzKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3RvcmUgaW52b2ljZSBQREYgVVJMJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52b2ljZSA9IHtcbiAgICAgICAgaWQ6ICdpbnYtMDAxJyxcbiAgICAgICAgcGRmVXJsOiAnaHR0cHM6Ly9pbnZvaWNlcy5leGFtcGxlLmNvbS9pbnYtMDAxLnBkZicsXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QoaW52b2ljZS5wZGZVcmwpLnRvTWF0Y2goL2h0dHBzOlxcL1xcLy8pO1xuICAgICAgZXhwZWN0KGludm9pY2UucGRmVXJsKS50b0NvbnRhaW4oaW52b2ljZS5pZCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNdWx0aS10ZW5hbmN5IGluIEJpbGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpc29sYXRlIGJpbGxpbmcgYnkgY2h1cmNoSWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBiaWxsaW5nMSA9IHsgY2h1cmNoSWQ6ICdjaHVyY2gtMScsIGFtb3VudDogOTkuOTkgfTtcbiAgICAgIGNvbnN0IGJpbGxpbmcyID0geyBjaHVyY2hJZDogJ2NodXJjaC0yJywgYW1vdW50OiAxOTkuOTkgfTtcblxuICAgICAgZXhwZWN0KGJpbGxpbmcxLmNodXJjaElkKS5ub3QudG9CZShiaWxsaW5nMi5jaHVyY2hJZCk7XG4gICAgICBleHBlY3QoYmlsbGluZzEuYW1vdW50KS5ub3QudG9CZShiaWxsaW5nMi5hbW91bnQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IHZpZXdpbmcgb3RoZXIgY2h1cmNoIGludm9pY2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdXNlckNodXJjaElkOiBzdHJpbmcgPSAnY2h1cmNoLTEnO1xuICAgICAgY29uc3QgaW52b2ljZUNodXJjaElkOiBzdHJpbmcgPSAnY2h1cmNoLTInO1xuXG4gICAgICBleHBlY3QodXNlckNodXJjaElkKS5ub3QudG9CZShpbnZvaWNlQ2h1cmNoSWQpO1xuICAgICAgY29uc3QgY2FuQWNjZXNzID0gdXNlckNodXJjaElkID09PSBpbnZvaWNlQ2h1cmNoSWQ7XG4gICAgICBleHBlY3QoY2FuQWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW5mb3JjZSBjaHVyY2ggaXNvbGF0aW9uIGluIGJpbGxpbmcgdXBkYXRlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNodXJjaDFCaWxsaW5nRW1haWwgPSAnYmlsbGluZ0BjaHVyY2gxLmNvbSc7XG4gICAgICBjb25zdCBjaHVyY2gyQmlsbGluZ0VtYWlsID0gJ2JpbGxpbmdAY2h1cmNoMi5jb20nO1xuXG4gICAgICBleHBlY3QoY2h1cmNoMUJpbGxpbmdFbWFpbCkubm90LnRvQmUoY2h1cmNoMkJpbGxpbmdFbWFpbCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZWZ1bmQgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB0cmFjayByZWZ1bmQgcmVxdWVzdHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZWZ1bmQgPSB7XG4gICAgICAgIGlkOiAncmVmdW5kLTAwMScsXG4gICAgICAgIGNoYXJnZUlkOiAnY2hhcmdlLTEyMycsXG4gICAgICAgIGFtb3VudDogOTkuOTksXG4gICAgICAgIHJlYXNvbjogJ0JpbGxpbmcgZXJyb3InLFxuICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChyZWZ1bmQuc3RhdHVzKS50b0JlKCdwZW5kaW5nJyk7XG4gICAgICBleHBlY3QocmVmdW5kLmFtb3VudCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyByZWZ1bmRzIHdpdGhpbiAzMCBkYXlzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2hhcmdlRGF0ZSA9IG5ldyBEYXRlKCcyMDI1LTExLTAxJyk7XG4gICAgICBjb25zdCByZWZ1bmREYXRlID0gbmV3IERhdGUoJzIwMjUtMTEtMzAnKTtcbiAgICAgIGNvbnN0IGRheXNFbGFwc2VkID0gTWF0aC5mbG9vcigocmVmdW5kRGF0ZS5nZXRUaW1lKCkgLSBjaGFyZ2VEYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuXG4gICAgICBleHBlY3QoZGF5c0VsYXBzZWQpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMzApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IHJlZnVuZHMgb2xkZXIgdGhhbiAzMCBkYXlzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2hhcmdlRGF0ZSA9IG5ldyBEYXRlKCcyMDI1LTEwLTAxJyk7XG4gICAgICBjb25zdCByZWZ1bmREYXRlID0gbmV3IERhdGUoJzIwMjUtMTItMDEnKTtcbiAgICAgIGNvbnN0IGRheXNFbGFwc2VkID0gTWF0aC5mbG9vcigocmVmdW5kRGF0ZS5nZXRUaW1lKCkgLSBjaGFyZ2VEYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuXG4gICAgICBleHBlY3QoZGF5c0VsYXBzZWQpLnRvQmVHcmVhdGVyVGhhbigzMCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=