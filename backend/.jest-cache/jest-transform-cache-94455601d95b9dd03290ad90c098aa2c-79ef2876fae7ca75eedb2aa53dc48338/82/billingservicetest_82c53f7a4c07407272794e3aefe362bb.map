{"file":"C:\\Users\\Windows\\OneDrive - Seattle Colleges\\Desktop\\YWMESSAGING\\backend\\src\\__tests__\\services\\billing.service.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\Windows\\OneDrive - Seattle Colleges\\Desktop\\YWMESSAGING\\backend\\src\\__tests__\\services\\billing.service.test.ts"],"sourcesContent":["import { describe, it, expect } from '@jest/globals';\n\nconst mockChurch = {\n  id: 'church-1',\n  name: 'Grace Community Church',\n  plan: 'professional',\n  stripeCustomerId: 'cus_test123',\n};\n\nconst mockBillingData = {\n  churchId: 'church-1',\n  monthlyContacts: 1500,\n  monthlyMessages: 50,\n  monthlyPrice: 99.99,\n  planLimits: {\n    contacts: 5000,\n    messagesPerMonth: 1000,\n    storageGb: 50,\n  },\n};\n\ndescribe('Billing Service', () => {\n  describe('Plan Validation', () => {\n    it('should validate plan types', () => {\n      const validPlans = ['free', 'starter', 'professional', 'enterprise'];\n      const invalidPlan = 'unknown';\n\n      expect(validPlans.includes('professional')).toBe(true);\n      expect(validPlans.includes(invalidPlan)).toBe(false);\n    });\n\n    it('should retrieve correct plan limits', () => {\n      const plans = {\n        free: { contacts: 100, messagesPerMonth: 10 },\n        starter: { contacts: 500, messagesPerMonth: 100 },\n        professional: { contacts: 5000, messagesPerMonth: 1000 },\n      };\n\n      expect(plans['professional'].contacts).toBe(5000);\n      expect(plans['professional'].messagesPerMonth).toBe(1000);\n    });\n\n    it('should escalate limits for higher tiers', () => {\n      const contactLimits: { [key: string]: number } = {\n        free: 100,\n        starter: 500,\n        professional: 5000,\n        enterprise: 50000,\n      };\n\n      expect(contactLimits.free).toBeLessThan(contactLimits.starter);\n      expect(contactLimits.starter).toBeLessThan(contactLimits.professional);\n      expect(contactLimits.professional).toBeLessThan(contactLimits.enterprise);\n    });\n  });\n\n  describe('Usage Tracking', () => {\n    it('should track monthly contact count', () => {\n      const usage = {\n        churchId: 'church-1',\n        month: 'December',\n        contactsUsed: 1500,\n        contactsLimit: 5000,\n      };\n\n      expect(usage.contactsUsed).toBeLessThan(usage.contactsLimit);\n    });\n\n    it('should track monthly message count', () => {\n      const usage = {\n        churchId: 'church-1',\n        month: 'December',\n        messagesUsed: 450,\n        messagesLimit: 1000,\n      };\n\n      expect(usage.messagesUsed).toBeLessThan(usage.messagesLimit);\n    });\n\n    it('should alert when approaching limits (90%)', () => {\n      const usage = {\n        contactsUsed: 4800,\n        contactsLimit: 5000,\n        percentageUsed: (4800 / 5000) * 100,\n      };\n\n      expect(usage.percentageUsed).toBeGreaterThan(90);\n    });\n\n    it('should calculate percentage usage correctly', () => {\n      const usage = {\n        used: 50,\n        limit: 100,\n        percentage: (50 / 100) * 100,\n      };\n\n      expect(usage.percentage).toBe(50);\n    });\n  });\n\n  describe('Overage Calculations', () => {\n    it('should calculate overages correctly', () => {\n      const usage = 5100;\n      const limit = 5000;\n      const overageAmount = usage - limit;\n      const overageCharge = overageAmount * 0.10; // $0.10 per overage contact\n\n      expect(overageAmount).toBe(100);\n      expect(overageCharge).toBe(10);\n    });\n\n    it('should apply overage only when exceeding limit', () => {\n      const withinLimit = { used: 4500, limit: 5000 };\n      const exceedingLimit = { used: 5500, limit: 5000 };\n\n      expect(withinLimit.used).toBeLessThanOrEqual(withinLimit.limit);\n      expect(exceedingLimit.used).toBeGreaterThan(exceedingLimit.limit);\n    });\n\n    it('should not charge overage when under limit', () => {\n      const usage = { used: 4000, limit: 5000 };\n      const overage = Math.max(0, usage.used - usage.limit);\n\n      expect(overage).toBe(0);\n    });\n\n    it('should cap total charges at monthly maximum', () => {\n      const basePlan = 99.99;\n      const maxOverage = 500; // Cap at $500/month\n      const totalCharge = Math.min(basePlan + maxOverage, basePlan + maxOverage);\n\n      expect(totalCharge).toBeLessThanOrEqual(basePlan + maxOverage);\n    });\n  });\n\n  describe('Payment Processing', () => {\n    it('should validate card number format', () => {\n      const cardNumber = '4242424242424242';\n      const isValidLength = cardNumber.length === 16;\n      const isNumeric = /^\\d+$/.test(cardNumber);\n\n      expect(isValidLength).toBe(true);\n      expect(isNumeric).toBe(true);\n    });\n\n    it('should require valid Stripe customer ID', () => {\n      const validStripeId = 'cus_test123';\n      const invalidStripeId = 'invalid';\n\n      expect(validStripeId).toMatch(/^cus_/);\n      expect(invalidStripeId).not.toMatch(/^cus_/);\n    });\n\n    it('should track payment status', () => {\n      const paymentStatuses = ['pending', 'processing', 'succeeded', 'failed'];\n      const validStatus = 'succeeded';\n\n      expect(paymentStatuses.includes(validStatus)).toBe(true);\n    });\n\n    it('should prevent duplicate charges', () => {\n      const charges = [\n        { id: 'charge-1', amount: 99.99, status: 'succeeded' },\n        { id: 'charge-1', amount: 99.99, status: 'succeeded' },\n      ];\n\n      const uniqueCharges = [...new Set(charges.map(c => c.id))];\n      expect(uniqueCharges.length).toBe(1);\n    });\n  });\n\n  describe('Trial Management', () => {\n    it('should track trial start and end dates', () => {\n      const trial = {\n        churchId: 'church-1',\n        startDate: new Date('2025-12-01'),\n        endDate: new Date('2025-12-31'),\n        daysRemaining: 30,\n      };\n\n      expect(trial.startDate).toBeTruthy();\n      expect(trial.endDate.getTime()).toBeGreaterThan(trial.startDate.getTime());\n      expect(trial.daysRemaining).toBeGreaterThan(0);\n    });\n\n    it('should prevent actions after trial expires', () => {\n      const today = new Date('2025-12-15');\n      const expiredTrial = {\n        endDate: new Date('2025-12-14'),\n        isExpired: today > new Date('2025-12-14'),\n      };\n\n      expect(expiredTrial.isExpired).toBe(true);\n    });\n\n    it('should enforce payment before conversion from trial', () => {\n      const conversion = {\n        requiresPayment: true,\n        trialEnded: true,\n        planSelected: 'professional',\n      };\n\n      expect(conversion.requiresPayment).toBe(true);\n      expect(conversion.trialEnded).toBe(true);\n    });\n\n    it('should set trial duration to 14 days by default', () => {\n      const startDate = new Date('2025-12-01');\n      const endDate = new Date(startDate);\n      endDate.setDate(endDate.getDate() + 14);\n\n      const durationDays = Math.floor((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));\n      expect(durationDays).toBe(14);\n    });\n  });\n\n  describe('Invoice Generation', () => {\n    it('should generate invoice with all required fields', () => {\n      const invoice = {\n        id: 'inv-001',\n        churchId: 'church-1',\n        date: new Date(),\n        amount: 99.99,\n        status: 'paid',\n        items: [\n          { description: 'Professional Plan', amount: 79.99 },\n          { description: 'Overage (100 contacts)', amount: 20.00 },\n        ],\n      };\n\n      expect(invoice.id).toBeTruthy();\n      expect(invoice.amount).toBeGreaterThan(0);\n      expect(invoice.items.length).toBeGreaterThan(0);\n      expect(invoice.status).toBe('paid');\n    });\n\n    it('should total invoice items correctly', () => {\n      const items = [\n        { description: 'Plan', amount: 79.99 },\n        { description: 'Overage', amount: 20.00 },\n      ];\n      const total = items.reduce((sum, item) => sum + item.amount, 0);\n\n      expect(total).toBeCloseTo(99.99, 2);\n    });\n\n    it('should track invoice payment status', () => {\n      const validStatuses = ['pending', 'paid', 'failed', 'refunded'];\n      const invoice = { status: 'paid' };\n\n      expect(validStatuses.includes(invoice.status)).toBe(true);\n    });\n\n    it('should store invoice PDF URL', () => {\n      const invoice = {\n        id: 'inv-001',\n        pdfUrl: 'https://invoices.example.com/inv-001.pdf',\n      };\n\n      expect(invoice.pdfUrl).toMatch(/https:\\/\\//);\n      expect(invoice.pdfUrl).toContain(invoice.id);\n    });\n  });\n\n  describe('Multi-tenancy in Billing', () => {\n    it('should isolate billing by churchId', () => {\n      const billing1 = { churchId: 'church-1', amount: 99.99 };\n      const billing2 = { churchId: 'church-2', amount: 199.99 };\n\n      expect(billing1.churchId).not.toBe(billing2.churchId);\n      expect(billing1.amount).not.toBe(billing2.amount);\n    });\n\n    it('should prevent viewing other church invoices', () => {\n      const userChurchId: string = 'church-1';\n      const invoiceChurchId: string = 'church-2';\n\n      expect(userChurchId).not.toBe(invoiceChurchId);\n      const canAccess = userChurchId === invoiceChurchId;\n      expect(canAccess).toBe(false);\n    });\n\n    it('should enforce church isolation in billing updates', () => {\n      const church1BillingEmail = 'billing@church1.com';\n      const church2BillingEmail = 'billing@church2.com';\n\n      expect(church1BillingEmail).not.toBe(church2BillingEmail);\n    });\n  });\n\n  describe('Refund Handling', () => {\n    it('should track refund requests', () => {\n      const refund = {\n        id: 'refund-001',\n        chargeId: 'charge-123',\n        amount: 99.99,\n        reason: 'Billing error',\n        status: 'pending',\n      };\n\n      expect(refund.status).toBe('pending');\n      expect(refund.amount).toBeGreaterThan(0);\n    });\n\n    it('should allow refunds within 30 days', () => {\n      const chargeDate = new Date('2025-11-01');\n      const refundDate = new Date('2025-11-30');\n      const daysElapsed = Math.floor((refundDate.getTime() - chargeDate.getTime()) / (1000 * 60 * 60 * 24));\n\n      expect(daysElapsed).toBeLessThanOrEqual(30);\n    });\n\n    it('should prevent refunds older than 30 days', () => {\n      const chargeDate = new Date('2025-10-01');\n      const refundDate = new Date('2025-12-01');\n      const daysElapsed = Math.floor((refundDate.getTime() - chargeDate.getTime()) / (1000 * 60 * 60 * 24));\n\n      expect(daysElapsed).toBeGreaterThan(30);\n    });\n  });\n});\n"],"version":3}