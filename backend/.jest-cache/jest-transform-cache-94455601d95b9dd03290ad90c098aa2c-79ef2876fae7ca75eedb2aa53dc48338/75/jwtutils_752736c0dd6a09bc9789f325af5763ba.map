{"file":"C:\\Users\\Windows\\OneDrive - Seattle Colleges\\Desktop\\YWMESSAGING\\backend\\src\\utils\\jwt.utils.ts","mappings":";;;;;AAgCA,kDAMC;AAKD,oDAMC;AAKD,8CAOC;AAKD,gDAOC;AAMD,0DAMC;AAKD,sDAOC;AAKD,kCAMC;AA5GD,gEAA+B;AAE/B,MAAM,aAAa,GAAW,OAAO,CAAC,GAAG,CAAC,iBAAiB,IAAI,EAAE,CAAC;AAClE,MAAM,cAAc,GAAW,OAAO,CAAC,GAAG,CAAC,kBAAkB,IAAI,EAAE,CAAC;AAEpE,sCAAsC;AACtC,IAAI,CAAC,aAAa,EAAE,CAAC;IACnB,MAAM,IAAI,KAAK,CAAC,oDAAoD,CAAC,CAAC;AACxE,CAAC;AACD,IAAI,CAAC,cAAc,EAAE,CAAC;IACpB,MAAM,IAAI,KAAK,CAAC,qDAAqD,CAAC,CAAC;AACzE,CAAC;AAkBD;;GAEG;AACH,SAAgB,mBAAmB,CAAC,OAAe,EAAE,QAAgB,EAAE,IAAY;IACjF,OAAO,sBAAG,CAAC,IAAI,CACb,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,EAC3B,aAAa,EACb,EAAE,SAAS,EAAE,KAAK,EAAE,CACrB,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAgB,oBAAoB,CAAC,OAAe,EAAE,QAAgB;IACpE,OAAO,sBAAG,CAAC,IAAI,CACb,EAAE,OAAO,EAAE,QAAQ,EAAE,EACrB,cAAc,EACd,EAAE,SAAS,EAAE,IAAI,EAAE,CACpB,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAgB,iBAAiB,CAAC,KAAa;IAC7C,IAAI,CAAC;QACH,MAAM,OAAO,GAAG,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,aAAa,CAAY,CAAC;QAC5D,OAAO,OAA6B,CAAC;IACvC,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,IAAI,CAAC;IACd,CAAC;AACH,CAAC;AAED;;GAEG;AACH,SAAgB,kBAAkB,CAAC,KAAa;IAC9C,IAAI,CAAC;QACH,MAAM,OAAO,GAAG,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,cAAc,CAAY,CAAC;QAC7D,OAAO,OAA8B,CAAC;IACxC,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,IAAI,CAAC;IACd,CAAC;AACH,CAAC;AAED;;;GAGG;AACH,SAAgB,uBAAuB,CAAC,OAAe,EAAE,QAAgB;IACvE,OAAO,sBAAG,CAAC,IAAI,CACb,EAAE,OAAO,EAAE,QAAQ,EAAE,EACrB,aAAa,EAAE,sBAAsB;IACrC,EAAE,SAAS,EAAE,IAAI,EAAE,CACpB,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAgB,qBAAqB,CAAC,KAAa;IACjD,IAAI,CAAC;QACH,MAAM,OAAO,GAAG,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,aAAa,CAAY,CAAC;QAC5D,OAAO,OAAiC,CAAC;IAC3C,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,IAAI,CAAC;IACd,CAAC;AACH,CAAC;AAED;;GAEG;AACH,SAAgB,WAAW,CAAC,KAAa;IACvC,IAAI,CAAC;QACH,OAAO,sBAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IAC3B,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,IAAI,CAAC;IACd,CAAC;AACH,CAAC","names":[],"sources":["C:\\Users\\Windows\\OneDrive - Seattle Colleges\\Desktop\\YWMESSAGING\\backend\\src\\utils\\jwt.utils.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\n\nconst ACCESS_SECRET: string = process.env.JWT_ACCESS_SECRET || '';\nconst REFRESH_SECRET: string = process.env.JWT_REFRESH_SECRET || '';\n\n// Validate secrets are set at startup\nif (!ACCESS_SECRET) {\n  throw new Error('JWT_ACCESS_SECRET environment variable is required');\n}\nif (!REFRESH_SECRET) {\n  throw new Error('JWT_REFRESH_SECRET environment variable is required');\n}\n\nexport interface AccessTokenPayload {\n  adminId: string;\n  churchId: string;\n  role: string;\n}\n\nexport interface RefreshTokenPayload {\n  adminId: string;\n  churchId: string;\n}\n\nexport interface MFASessionTokenPayload {\n  adminId: string;\n  churchId: string;\n}\n\n/**\n * Generate access token (short-lived: 15 minutes)\n */\nexport function generateAccessToken(adminId: string, churchId: string, role: string): string {\n  return jwt.sign(\n    { adminId, churchId, role },\n    ACCESS_SECRET,\n    { expiresIn: '15m' }\n  );\n}\n\n/**\n * Generate refresh token (long-lived: 7 days)\n */\nexport function generateRefreshToken(adminId: string, churchId: string): string {\n  return jwt.sign(\n    { adminId, churchId },\n    REFRESH_SECRET,\n    { expiresIn: '7d' }\n  );\n}\n\n/**\n * Verify access token\n */\nexport function verifyAccessToken(token: string): AccessTokenPayload | null {\n  try {\n    const payload = jwt.verify(token, ACCESS_SECRET) as unknown;\n    return payload as AccessTokenPayload;\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Verify refresh token\n */\nexport function verifyRefreshToken(token: string): RefreshTokenPayload | null {\n  try {\n    const payload = jwt.verify(token, REFRESH_SECRET) as unknown;\n    return payload as RefreshTokenPayload;\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Generate MFA session token (very short-lived: 5 minutes)\n * Used during MFA verification step in login flow\n */\nexport function generateMFASessionToken(adminId: string, churchId: string): string {\n  return jwt.sign(\n    { adminId, churchId },\n    ACCESS_SECRET, // Reuse access secret\n    { expiresIn: '5m' }\n  );\n}\n\n/**\n * Verify MFA session token\n */\nexport function verifyMFASessionToken(token: string): MFASessionTokenPayload | null {\n  try {\n    const payload = jwt.verify(token, ACCESS_SECRET) as unknown;\n    return payload as MFASessionTokenPayload;\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Decode token without verification (for debugging)\n */\nexport function decodeToken(token: string): any {\n  try {\n    return jwt.decode(token);\n  } catch (error) {\n    return null;\n  }\n}\n"],"version":3}