import{r as i,j as e,C as b,B as c,_ as o}from"./index-lmnw-XEH.js";import{u as M}from"./groupStore-MPnCNJHm.js";import{u as F,s as E}from"./messages-IcvzAxm5.js";import{g as B,T as z}from"./TemplateFormModal-BvJSc3Ze.js";import{B as G}from"./BackButton-Cp14XviA.js";import"./index.esm-DJ_b4t4r.js";function _(){const{groups:p}=M(),{addMessage:N}=F(),[t,d]=i.useState(""),[a,g]=i.useState("groups"),[r,x]=i.useState([]),[m,y]=i.useState(!1),[u,k]=i.useState([]),[v,j]=i.useState(!1);i.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await B();k(s)}catch(s){console.error("Failed to load templates:",s)}},n=Math.ceil(t.length/160)||0,C=n*r.length*.0075,S=r.reduce((s,l)=>s+(p.find(h=>h.id===l)?.memberCount||0),0),w=s=>{x(l=>l.includes(s)?l.filter(h=>h!==s):[...l,s])},D=s=>{d(s.content),o.success(`Using template: ${s.name}`)},T=async()=>{if(!t.trim()){o.error("Please enter a message");return}if(a==="groups"&&r.length===0){o.error("Please select at least one group");return}try{y(!0);const s=await E({content:t.trim(),targetType:a==="all"?"all":"groups",targetIds:a==="all"?void 0:r});N(s),o.success(`Message queued for ${s.totalRecipients} recipients`),d(""),x([])}catch(s){o.error(s.message||"Failed to send message")}finally{y(!1)}};return e.jsxs("div",{className:"min-h-screen bg-slate-950 p-6 transition-colors duration-normal",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsx(G,{variant:"ghost"})}),e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"ðŸ“¨ Send Message"}),e.jsx("p",{className:"text-slate-300",children:"Reach your congregation with direct SMS messages"})]})}),e.jsxs(b,{variant:"default",className:"space-y-6",children:[u.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-primary-900 dark:text-primary-50 mb-3",children:"ðŸ“‹ Use Template"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[u.slice(0,6).map(s=>e.jsx(c,{variant:"secondary",size:"sm",onClick:()=>D(s),title:s.content,children:s.name},s.id)),u.length>6&&e.jsx(c,{variant:"outline",size:"sm",onClick:()=>window.location.href="/templates",children:"More Templates..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-primary-900 dark:text-primary-50 mb-3",children:"âœï¸ Message Content"}),e.jsx("textarea",{value:t,onChange:s=>d(s.target.value.slice(0,1600)),className:"w-full px-4 py-3 border border-primary-200 dark:border-primary-700 rounded-lg bg-white dark:bg-primary-800 text-primary-900 dark:text-primary-50 placeholder-primary-400 dark:placeholder-primary-500 focus:outline-none focus:ring-2 focus:ring-accent-500 resize-none transition-colors duration-normal",rows:6,placeholder:"Type your message here...",maxLength:1600}),e.jsxs("div",{className:"flex justify-between mt-3 text-sm text-primary-600 dark:text-primary-400",children:[e.jsxs("span",{children:[t.length," / 1600 characters"]}),e.jsxs("span",{children:[n," SMS segment",n!==1?"s":"",n>0&&` ($${(n*.0075).toFixed(4)} per recipient)`]})]}),t.trim()&&e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>j(!0),className:"mt-2",children:"ðŸ’¾ Save as Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-primary-900 dark:text-primary-50 mb-3",children:"ðŸ‘¥ Send To"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"radio",name:"targetType",value:"groups",checked:a==="groups",onChange:s=>g(s.target.value),className:"w-4 h-4 accent-accent-500 dark:accent-accent-400 cursor-pointer"}),e.jsx("span",{className:"text-sm font-medium text-primary-900 dark:text-primary-50",children:"Select Groups"})]}),a==="groups"&&e.jsx("div",{className:"ml-7 space-y-2 bg-primary-100 dark:bg-primary-800 p-4 rounded-lg border border-primary-200 dark:border-primary-700",children:p.length===0?e.jsx("p",{className:"text-primary-600 dark:text-primary-400 text-sm",children:"No groups available"}):p.map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:r.includes(s.id),onChange:()=>w(s.id),className:"w-4 h-4 rounded accent-accent-500 dark:accent-accent-400 cursor-pointer"}),e.jsxs("span",{className:"text-sm text-primary-700 dark:text-primary-300",children:[s.name," (",s.memberCount," members)"]})]},s.id))}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"radio",name:"targetType",value:"all",checked:a==="all",onChange:s=>g(s.target.value),className:"w-4 h-4 accent-accent-500 dark:accent-accent-400 cursor-pointer"}),e.jsx("span",{className:"text-sm font-medium text-primary-900 dark:text-primary-50",children:"All Members"})]})]})]}),(a==="all"||r.length>0)&&n>0&&e.jsx(b,{variant:"highlight",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-primary-700 dark:text-primary-300",children:"Recipients:"}),e.jsx("span",{className:"font-medium text-primary-900 dark:text-primary-50",children:S})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-primary-700 dark:text-primary-300",children:"Segments:"}),e.jsx("span",{className:"font-medium text-primary-900 dark:text-primary-50",children:n})]}),e.jsxs("div",{className:"flex justify-between border-t border-primary-200 dark:border-primary-700 pt-2",children:[e.jsx("span",{className:"font-medium text-primary-900 dark:text-primary-50",children:"Estimated Cost:"}),e.jsxs("span",{className:"font-bold text-accent-600 dark:text-accent-400",children:["$",C.toFixed(2)]})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:()=>{d(""),x([])},disabled:m,children:"ðŸ—‘ï¸ Clear"}),e.jsx(c,{variant:"primary",size:"md",fullWidth:!0,onClick:T,disabled:m||!t.trim()||a==="groups"&&r.length===0,isLoading:m,children:m?"Sending...":"âœ‰ï¸ Send Message"})]})]})]}),v&&e.jsx(z,{template:null,onClose:()=>{j(!1),f()}})]})}export{_ as SendMessagePage,_ as default};
//# sourceMappingURL=SendMessagePage-IwUN8--M.js.map
