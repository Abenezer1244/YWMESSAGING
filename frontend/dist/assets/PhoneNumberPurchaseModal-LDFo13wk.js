import{c as h,r as o,j as e,B as x,_ as c}from"./index-D79gy8ca.js";import{c as O,A as W,X as Y}from"./index-C8FwcOmm.js";import{m as l}from"./proxy-NUkvTX8g.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],F=O("phone",_);async function q(a){const s=new URLSearchParams;return a.areaCode&&s.append("areaCode",a.areaCode),a.state&&s.append("state",a.state),a.contains&&s.append("contains",a.contains),a.quantity&&s.append("quantity",a.quantity.toString()),(await h.get(`/numbers/search?${s.toString()}`)).data.data}async function H(a){return(await h.post("/numbers/setup-payment-intent",{phoneNumber:a})).data}async function U(a,s,m,d,i){return(await h.post("/numbers/confirm-payment",{paymentIntentId:a,cardNumber:s,cardExpiry:m,cardCvc:d,cardName:i})).data}async function V(a,s,m){return(await h.post("/numbers/purchase",{phoneNumber:a,paymentIntentId:s,connectionId:m})).data}async function Z(){return(await h.get("/numbers/current")).data.data}const G=[{code:"CA",name:"California"},{code:"NY",name:"New York"},{code:"TX",name:"Texas"},{code:"FL",name:"Florida"},{code:"IL",name:"Illinois"},{code:"PA",name:"Pennsylvania"},{code:"OH",name:"Ohio"},{code:"GA",name:"Georgia"},{code:"MI",name:"Michigan"},{code:"NC",name:"North Carolina"}];function ee({isOpen:a,onClose:s,onPurchaseComplete:m}){const[d,i]=o.useState("search"),[p,S]=o.useState(""),[w,P]=o.useState(""),[M,f]=o.useState([]),[n,g]=o.useState(null),[t,u]=o.useState(!1),[C,k]=o.useState(null),[b,I]=o.useState(""),[y,L]=o.useState(""),[v,A]=o.useState(""),[N,E]=o.useState(""),z=async()=>{if(!p&&!w){c.error("Please enter an area code or select a state");return}u(!0);try{const r=await q({areaCode:p||void 0,state:w||void 0,quantity:10});r.length===0?(c.error("No numbers found for that search"),f([])):(f(r),i("select"))}catch(r){console.error("Search failed:",r),c.error(r.message||"Failed to search numbers")}finally{u(!1)}},$=async r=>{g(r),i("confirm")},B=async()=>{if(n){u(!0);try{const r=await H(n.phoneNumber);if(!r.success||!r.data?.paymentIntentId)throw new Error("Failed to create payment intent");k(r.data.paymentIntentId),i("payment")}catch(r){console.error("Payment intent creation failed:",r),c.error(r.message||"Failed to create payment intent")}finally{u(!1)}}},D=async()=>{if(!(!n||!C)){u(!0);try{if(!b||!y||!v||!N){c.error("Please fill in all card details"),u(!1);return}c.loading("Processing payment...");const r=await U(C,b,y,v,N);if(!r.success||r.data?.status!=="succeeded")throw new Error("Payment confirmation failed");(await V(n.phoneNumber,C)).success&&(c.success(`Successfully purchased ${n.formattedNumber}!`),m&&m(n.phoneNumber),R(),s())}catch(r){console.error("Purchase failed:",r),c.error(r.message||"Failed to purchase number")}finally{u(!1)}}},R=()=>{i("search"),S(""),P(""),f([]),g(null),k(null),I(""),L(""),A(""),E("")},T={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.1}}},j={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3,type:"tween"}}};return e.jsx(W,{children:a&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4 backdrop-blur-md",children:e.jsxs(l.div,{initial:{opacity:0,scale:.92,y:30},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.92,y:30},transition:{duration:.4,ease:"easeOut"},className:"bg-background border border-border/50 rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-b border-border/30 p-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(F,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Buy Phone Number"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d==="search"&&"Search available numbers",d==="select"&&"Choose a number",d==="confirm"&&"Confirm purchase"]})]})]}),e.jsx(l.button,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:s,disabled:t,className:"p-2 hover:bg-muted rounded-lg transition-colors disabled:opacity-50",children:e.jsx(Y,{className:"w-5 h-5 text-muted-foreground"})})]}),e.jsx("div",{className:"p-6",children:e.jsxs(l.div,{variants:T,initial:"hidden",animate:"visible",children:[d==="search"&&e.jsxs(l.div,{variants:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Area Code"}),e.jsx("input",{type:"text",placeholder:"e.g., 415, 212, 310",value:p,onChange:r=>S(r.target.value),maxLength:3,className:"w-full px-3 py-2 border border-border/50 rounded-lg bg-background text-foreground placeholder-muted-foreground focus:border-primary focus:outline-none transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"State (Optional)"}),e.jsxs("select",{value:w,onChange:r=>P(r.target.value),className:"w-full px-3 py-2 border border-border/50 rounded-lg bg-background text-foreground focus:border-primary focus:outline-none transition-colors appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.5rem center",paddingRight:"2rem"},children:[e.jsx("option",{value:"",children:"Select a state..."}),G.map(r=>e.jsx("option",{value:r.code,children:r.name},r.code))]})]}),e.jsx(x,{variant:"primary",fullWidth:!0,size:"lg",onClick:z,disabled:t,isLoading:t,className:"bg-primary hover:bg-primary/90 text-background font-medium mt-6",children:t?"Searching...":"Search Numbers"})]}),d==="select"&&e.jsxs(l.div,{variants:j,className:"space-y-3",children:[e.jsx("div",{className:"space-y-2 max-h-72 overflow-y-auto",children:M.map(r=>e.jsx(l.button,{whileHover:{scale:1.02},onClick:()=>$(r),className:"w-full p-4 border-2 border-border/30 rounded-lg bg-muted/20 hover:border-primary/50 hover:bg-primary/5 transition-all text-left group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground text-lg",children:r.formattedNumber}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:r.region})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-foreground",children:["$",r.costPerSms.toFixed(4),"/SMS"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["$",r.costPerMinute.toFixed(4),"/min"]})]})]})},r.id))}),e.jsx(x,{variant:"secondary",fullWidth:!0,size:"sm",onClick:()=>{i("search"),f([]),g(null)},className:"mt-4",children:"Back to Search"})]}),d==="confirm"&&n&&e.jsxs(l.div,{variants:j,className:"space-y-4",children:[e.jsx("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(F,{className:"w-8 h-8 text-primary mx-auto mb-3"}),e.jsx("div",{className:"text-2xl font-bold text-foreground mb-1",children:n.formattedNumber}),e.jsx("div",{className:"text-sm text-muted-foreground",children:n.region})]})}),e.jsxs("div",{className:"space-y-2 bg-muted/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Per SMS:"}),e.jsxs("span",{className:"font-medium text-foreground",children:["$",n.costPerSms.toFixed(4)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Per minute:"}),e.jsxs("span",{className:"font-medium text-foreground",children:["$",n.costPerMinute.toFixed(4)]})]}),e.jsxs("div",{className:"border-t border-border/30 pt-2 mt-2 flex justify-between font-semibold",children:[e.jsx("span",{className:"text-foreground",children:"One-time setup:"}),e.jsx("span",{className:"text-primary",children:"$4.99"})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3",children:"By purchasing, you agree to Telnyx's terms and will be charged the one-time setup fee. Usage charges apply separately."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{variant:"primary",fullWidth:!0,size:"lg",onClick:B,disabled:t,isLoading:t,className:"bg-primary hover:bg-primary/90 text-background font-medium",children:t?"Processing...":"Continue to Payment"}),e.jsx(x,{variant:"secondary",fullWidth:!0,size:"sm",onClick:()=>{i("select"),g(null)},disabled:t,children:"Choose Different Number"})]})]}),d==="payment"&&n&&e.jsxs(l.div,{variants:j,className:"space-y-4",children:[e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-foreground mb-2",children:["Payment for ",n.formattedNumber]}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:"$4.99"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"One-time setup fee"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"Cardholder Name"}),e.jsx("input",{type:"text",placeholder:"John Doe",value:N,onChange:r=>E(r.target.value),disabled:t,className:"w-full px-3 py-2 bg-muted border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"Card Number"}),e.jsx("input",{type:"text",placeholder:"4242 4242 4242 4242",value:b,onChange:r=>I(r.target.value.replace(/\s/g,"")),disabled:t,maxLength:19,className:"w-full px-3 py-2 bg-muted border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 font-mono"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Test card: 4242 4242 4242 4242"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"Expiry (MM/YY)"}),e.jsx("input",{type:"text",placeholder:"12/25",value:y,onChange:r=>L(r.target.value),disabled:t,maxLength:5,className:"w-full px-3 py-2 bg-muted border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"CVC"}),e.jsx("input",{type:"text",placeholder:"123",value:v,onChange:r=>A(r.target.value.replace(/\D/g,"")),disabled:t,maxLength:4,className:"w-full px-3 py-2 bg-muted border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 font-mono"})]})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:"ðŸ”’ Payment is processed securely. Your card details are only used to process this transaction."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{variant:"primary",fullWidth:!0,size:"lg",onClick:D,disabled:t||!b||!y||!v||!N,isLoading:t,className:"bg-primary hover:bg-primary/90 text-background font-medium",children:t?"Processing Payment...":"Complete Purchase"}),e.jsx(x,{variant:"secondary",fullWidth:!0,size:"sm",onClick:()=>i("confirm"),disabled:t,children:"Back"})]})]})]})})]})})})}export{ee as P,F as a,Z as g};
//# sourceMappingURL=PhoneNumberPurchaseModal-LDFo13wk.js.map
