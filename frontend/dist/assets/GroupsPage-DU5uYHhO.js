import{k as w,r as h,j as e,_ as m,m as k,S as C,B as c,C as N}from"./index-CJzYWU1Y.js";import{u as M}from"./groupStore-2uWAO1Aa.js";import{u as G}from"./index.esm-Bem1cfJf.js";async function E(t){return(await w.get(`/branches/${t}/groups`)).data.data}async function D(t,a){return(await w.post(`/branches/${t}/groups`,a)).data.data}async function S(t,a){return(await w.put(`/groups/${t}`,a)).data.data}async function z(t){return(await w.delete(`/groups/${t}`)).data.data}function T({isOpen:t,group:a,branchId:n,onClose:g,onSuccess:u}){const{register:d,handleSubmit:x,reset:b,watch:p}=G({defaultValues:{name:a?.name||"",description:a?.description||"",welcomeMessageEnabled:a?.welcomeMessageEnabled||!1,welcomeMessageText:a?.welcomeMessageText||""}}),[o,i]=h.useState(!1),f=p("welcomeMessageEnabled"),y=async r=>{try{if(i(!0),a){const l=await S(a.id,{name:r.name,description:r.description||void 0,welcomeMessageEnabled:r.welcomeMessageEnabled,welcomeMessageText:r.welcomeMessageText||void 0});m.success("Group updated successfully"),u(l)}else{const l=await D(n,{name:r.name,description:r.description||void 0,welcomeMessageEnabled:r.welcomeMessageEnabled,welcomeMessageText:r.welcomeMessageText||void 0});m.success("Group created successfully"),u(l)}b(),g()}catch(l){m.error(l.message||"Failed to save group")}finally{i(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full mx-4 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:a?"Edit Group":"Create Group"}),e.jsxs("form",{onSubmit:x(y),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group Name *"}),e.jsx("input",{type:"text",...d("name",{required:!0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Young Adults"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{...d("description"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional group description",rows:3})]}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...d("welcomeMessageEnabled"),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Send welcome message when members join"})]}),f&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),e.jsx("textarea",{...d("welcomeMessageText"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter welcome message text",rows:3})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:g,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition",disabled:o,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition disabled:bg-gray-400",disabled:o,children:o?"Saving...":"Save"})]})]})]})}):null}function W(){const{branchId:t=""}=k(),{groups:a,setGroups:n,isLoading:g,setLoading:u}=M(),[d,x]=h.useState(!1),[b,p]=h.useState(),[o,i]=h.useState(null);h.useEffect(()=>{f()},[t]);const f=async()=>{try{u(!0);const s=await E(t);n(s)}catch(s){m.error(s.message||"Failed to load groups")}finally{u(!1)}},y=()=>{p(void 0),x(!0)},r=s=>{p(s),x(!0)},l=async s=>{try{await z(s),m.success("Group deleted successfully"),i(null),await f()}catch(j){m.error(j.message||"Failed to delete group")}},v=s=>{n(b?a.map(j=>j.id===s.id?s:j):[s,...a])};return g?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-secondary-50 dark:from-secondary-900 to-secondary-100 dark:to-secondary-950 flex items-center justify-center p-6",children:e.jsx(C,{size:"lg",text:"Loading groups..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-secondary-50 dark:from-secondary-900 to-secondary-100 dark:to-secondary-950 p-6 transition-colors duration-normal",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-secondary-900 dark:text-secondary-50 mb-2",children:"👥 Groups"}),e.jsxs("p",{className:"text-secondary-600 dark:text-secondary-400",children:[a.length," groups in this branch"]})]}),e.jsx(c,{variant:"primary",size:"lg",onClick:y,children:"+ New Group"})]}),a.length===0?e.jsxs(N,{variant:"highlight",className:"text-center py-16",children:[e.jsx("div",{className:"mb-6",children:e.jsx("span",{className:"text-6xl",children:"👥"})}),e.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-secondary-50 mb-3",children:"No Groups Yet"}),e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6 max-w-md mx-auto",children:"Create your first group to start organizing your congregation."}),e.jsx(c,{variant:"primary",size:"md",onClick:y,children:"Create First Group"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.map(s=>e.jsxs(N,{variant:"default",className:"hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900 dark:text-secondary-50",children:s.name}),s.description&&e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 text-sm mt-1",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"secondary",size:"sm",onClick:()=>r(s),children:"Edit"}),e.jsx(c,{variant:"danger",size:"sm",onClick:()=>i(s.id),children:"Delete"})]})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-secondary-200 dark:border-secondary-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 text-sm",children:"👤 Members"}),e.jsx("p",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:s.memberCount})]}),s.welcomeMessageEnabled&&e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 text-sm",children:"Welcome Message"}),e.jsx("p",{className:"text-sm text-success-600 dark:text-success-400 font-medium",children:"✅ Enabled"})]})]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>window.location.href=`/members?groupId=${s.id}`,fullWidth:!0,children:"👥 Manage Members"})]},s.id))})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(N,{variant:"default",className:"max-w-sm w-full",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary-900 dark:text-secondary-50 mb-2",children:"⚠️ Delete Group?"}),e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"This will delete the group and remove all members. This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:()=>i(null),fullWidth:!0,children:"Cancel"}),e.jsx(c,{variant:"danger",size:"md",onClick:()=>l(o),fullWidth:!0,children:"Delete"})]})]})}),e.jsx(T,{isOpen:d,group:b,branchId:t,onClose:()=>{x(!1),p(void 0)},onSuccess:v})]})}export{W as GroupsPage,W as default};
//# sourceMappingURL=GroupsPage-DU5uYHhO.js.map
