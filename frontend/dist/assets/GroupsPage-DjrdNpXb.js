import{r as h,j as e,_ as c,n as M}from"./index-CFW26Pgf.js";import{u as G}from"./groupStore-DXXLeZQo.js";import{u as C,c as E,g as S,d as T}from"./groups-DhumIxOS.js";import{u as L}from"./index.esm-CkdChMIS.js";import{a as k,L as I,S as N}from"./SoftLayout-Dd5K8bpG.js";import{S as l}from"./SoftButton-BTuYkZTH.js";import{m as w}from"./proxy-DqF6wZp7.js";import{c as F,U as z}from"./index-DE-2L1VE.js";import{P as D}from"./pen-CVd5yfRT.js";import{T as W}from"./trash-2-eGLtDFXb.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],P=F("triangle-alert",O);function _({isOpen:m,group:t,branchId:x,onClose:f,onSuccess:u}){const{register:n,handleSubmit:p,reset:b,watch:g}=L({defaultValues:{name:t?.name||"",description:t?.description||"",welcomeMessageEnabled:t?.welcomeMessageEnabled||!1,welcomeMessageText:t?.welcomeMessageText||""}}),[i,d]=h.useState(!1),j=g("welcomeMessageEnabled"),y=async a=>{try{if(d(!0),t){const r=await C(t.id,{name:a.name,description:a.description||void 0,welcomeMessageEnabled:a.welcomeMessageEnabled,welcomeMessageText:a.welcomeMessageText||void 0});c.success("Group updated successfully"),u(r)}else{const r=await E(x,{name:a.name,description:a.description||void 0,welcomeMessageEnabled:a.welcomeMessageEnabled,welcomeMessageText:a.welcomeMessageText||void 0});c.success("Group created successfully"),u(r)}b(),f()}catch(r){c.error(r.message||"Failed to save group")}finally{d(!1)}};return m?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-lg max-w-md w-full mx-4 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:t?"Edit Group":"Create Group"}),e.jsxs("form",{onSubmit:p(y),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Group Name *"}),e.jsx("input",{type:"text",...n("name",{required:!0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Young Adults"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{...n("description"),className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional group description",rows:3})]}),e.jsxs("div",{className:"space-y-3 border-t border-gray-300 dark:border-slate-600 pt-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...n("welcomeMessageEnabled"),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Send welcome message when members join"})]}),j&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Welcome Message"}),e.jsx("textarea",{...n("welcomeMessageText"),className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter welcome message text",rows:3})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:f,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-slate-700 transition",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition disabled:bg-gray-400",disabled:i,children:i?"Saving...":"Save"})]})]})]})}):null}function K(){const{branchId:m=""}=M(),{groups:t,setGroups:x,isLoading:f,setLoading:u}=G(),[n,p]=h.useState(!1),[b,g]=h.useState(),[i,d]=h.useState(null);h.useEffect(()=>{j()},[m]);const j=async()=>{try{u(!0);const s=await S(m);x(s)}catch(s){c.error(s.message||"Failed to load groups")}finally{u(!1)}},y=()=>{g(void 0),p(!0)},a=s=>{g(s),p(!0)},r=async s=>{try{await T(s),c.success("Group deleted successfully"),d(null),await j()}catch(o){c.error(o.message||"Failed to delete group")}},v=s=>{x(b?t.map(o=>o.id===s.id?s:o):[s,...t])};return f?e.jsx(k,{children:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:e.jsx(w.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(I,{className:"w-8 h-8 text-primary"})})})}):e.jsxs(k,{children:[e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between mb-8 flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Groups"})}),e.jsxs("p",{className:"text-muted-foreground",children:[t.length," groups in this branch"]})]}),e.jsx(l,{variant:"primary",size:"lg",onClick:y,children:"New Group"})]}),t.length===0?e.jsxs(N,{className:"text-center py-16",children:[e.jsx("div",{className:"mb-6",children:e.jsx(z,{className:"w-16 h-16 text-muted-foreground/50 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"No Groups Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Create your first group to start organizing your congregation."}),e.jsx(l,{variant:"primary",onClick:y,children:"Create First Group"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map((s,o)=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.05},children:e.jsxs(N,{variant:"default",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4 flex-wrap gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:s.name}),s.description&&e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"secondary",onClick:()=>a(s),children:e.jsx(D,{className:"w-4 h-4"})}),e.jsx(l,{variant:"danger",onClick:()=>d(s.id),children:e.jsx(W,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-border/40",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Members"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.memberCount})]}),s.welcomeMessageEnabled&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Welcome Message"}),e.jsx("p",{className:"text-sm text-green-400 font-medium",children:"Enabled"})]})]}),e.jsx(l,{variant:"secondary",onClick:()=>window.location.href=`/members?groupId=${s.id}`,fullWidth:!0,children:"Manage Members"})]})},s.id))})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:e.jsx(w.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},children:e.jsxs(N,{className:"max-w-sm w-full",children:[e.jsxs("div",{className:"flex gap-3 items-start mb-4",children:[e.jsx(P,{className:"w-6 h-6 text-red-400 flex-shrink-0"}),e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Delete Group?"})})]}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"This will delete the group and remove all members. This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{variant:"secondary",onClick:()=>d(null),fullWidth:!0,children:"Cancel"}),e.jsx(l,{variant:"danger",onClick:()=>r(i),fullWidth:!0,children:"Delete"})]})]})})}),e.jsx(_,{isOpen:n,group:b,branchId:m,onClose:()=>{p(!1),g(void 0)},onSuccess:v})]})}export{K as GroupsPage,K as default};
//# sourceMappingURL=GroupsPage-DjrdNpXb.js.map
