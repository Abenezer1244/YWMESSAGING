import{r as x,j as e,_ as o,h as E,i as F,a as L,d as P,k as q,m as z}from"./index-C4F4BrS0.js";import{u as A}from"./index.esm-DBxjv0rK.js";import{a as w,L as _,S as v}from"./SoftLayout-3IDO0g5p.js";import{S as b}from"./SoftButton-DvT70JHL.js";import{m as k}from"./proxy-D6E2wFT5.js";import{c as O}from"./index-CZGW8dGN.js";import{P as T}from"./pen-jbdIUzu5.js";import{T as I}from"./trash-2-CvXUSWI5.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],B=O("map-pin",W);function Y({isOpen:a,onClose:n,onSuccess:y,churchId:j,branch:s}){const[t,h]=x.useState(!1),{register:d,handleSubmit:N,reset:c,formState:{errors:u}}=A({defaultValues:{name:s?.name||"",address:s?.address||"",phone:s?.phone||"",description:s?.description||""}});if(!a)return null;const p=async i=>{if(!i.name||!i.name.trim()){o.error("Branch name is required");return}h(!0);try{let l;s?(l=await E(s.id,i),o.success("Branch updated successfully")):(l=await F(j,i),o.success("Branch created successfully")),c(),y(l),n()}catch(l){const f=l.response?.data?.error||"Failed to save branch";o.error(f)}finally{h(!1)}},g=()=>{c(),n()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:s?"Edit Branch":"Create New Branch"}),e.jsxs("form",{onSubmit:N(p),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Branch Name *"}),e.jsx("input",{type:"text",...d("name",{required:"Branch name is required"}),placeholder:"e.g., Main Location, Downtown Campus",className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t}),u.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Address"}),e.jsx("input",{type:"text",...d("address"),placeholder:"123 Main St, City, State",className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...d("phone"),placeholder:"(555) 123-4567",className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{...d("description"),placeholder:"Additional details about this branch...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:g,disabled:t,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 disabled:bg-gray-100 dark:disabled:bg-slate-700 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition",children:t?"Saving...":s?"Update":"Create"})]})]})]})})})}function Q(){const a=L(),{branches:n,setBranches:y,addBranch:j,updateBranch:s,removeBranch:t,isLoading:h,setLoading:d}=P(),[N,c]=x.useState(!1),[u,p]=x.useState(void 0),[g,i]=x.useState(null);x.useEffect(()=>{a.church?.id&&l()},[a.church?.id]);const l=async()=>{if(a.church?.id){d(!0);try{const r=await q(a.church.id);y(r)}catch(r){console.error("Failed to load branches:",r),o.error("Failed to load branches")}finally{d(!1)}}},f=()=>{p(void 0),c(!0)},S=r=>{p(r),c(!0)},C=r=>{u?s(r.id,r):j(r)},D=async r=>{if(window.confirm("Are you sure you want to delete this branch? This action cannot be undone.")){i(r);try{const m=await z(r);t(r),o.success(`Branch deleted. ${m.groupsDeleted} group(s) and ${m.membersDeleted} member(s) were removed.`)}catch(m){const M=m.response?.data?.error||"Failed to delete branch";o.error(M)}finally{i(null)}}};return h&&n.length===0?e.jsx(w,{children:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(k.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(_,{className:"w-8 h-8 text-primary"})})})}):e.jsxs(w,{children:[e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between mb-8 flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Branches"})}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your church locations"})]}),e.jsx(b,{variant:"primary",size:"lg",onClick:f,children:"New Branch"})]}),n.length===0?e.jsxs(v,{className:"text-center py-16",children:[e.jsx("div",{className:"mb-6",children:e.jsx(B,{className:"w-16 h-16 text-muted-foreground/50 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"No Branches Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Create your first branch to start managing your church locations and organizing your congregation."}),e.jsx(b,{variant:"primary",onClick:f,children:"Create Your First Branch"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map((r,m)=>e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.05},children:e.jsxs(v,{variant:"default",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-2",children:r.name}),r.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-border/40",children:[r.address&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(B,{className:"w-4 h-4 inline mr-2"}),r.address]}),r.phone&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ“ž ",r.phone]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:r.groupCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Groups"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:r.memberCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Members"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(b,{variant:"secondary",onClick:()=>S(r),fullWidth:!0,children:[e.jsx(T,{className:"w-4 h-4"}),"Edit"]}),e.jsxs(b,{variant:"danger",onClick:()=>D(r.id),disabled:g===r.id||n.length===1,fullWidth:!0,children:[e.jsx(I,{className:"w-4 h-4"}),g===r.id?"Deleting...":"Delete"]})]})]})},r.id))})]}),e.jsx(Y,{isOpen:N,onClose:()=>c(!1),onSuccess:C,churchId:a.church?.id||"",branch:u})]})}export{Q as BranchesPage,Q as default};
//# sourceMappingURL=BranchesPage-cL5-1OGh.js.map
