import{r as x,j as e,_ as o,d as E,e as F,a as L,c as A,h as P,i as q}from"./index-DACdgf-S.js";import{u as z}from"./index.esm-nHR8sSmi.js";import{a as w,L as _,S as B}from"./SoftLayout-BOxG7bEu.js";import{S as b}from"./SoftButton-C8s7n6DK.js";import{m as v,A as O}from"./AnimatedBlobs-6TlZXHI-.js";import{c as T}from"./zap-CsNeuOz0.js";import{P as I}from"./pen-BTUhokhu.js";import{T as W}from"./trash-2-BY8DAuM0.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],S=T("map-pin",Y);function $({isOpen:a,onClose:n,onSuccess:y,churchId:j,branch:r}){const[t,h]=x.useState(!1),{register:i,handleSubmit:N,reset:c,formState:{errors:u}}=z({defaultValues:{name:r?.name||"",address:r?.address||"",phone:r?.phone||"",description:r?.description||""}});if(!a)return null;const p=async l=>{if(!l.name||!l.name.trim()){o.error("Branch name is required");return}h(!0);try{let d;r?(d=await E(r.id,l),o.success("Branch updated successfully")):(d=await F(j,l),o.success("Branch created successfully")),c(),y(d),n()}catch(d){const g=d.response?.data?.error||"Failed to save branch";o.error(g)}finally{h(!1)}},f=()=>{c(),n()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:r?"Edit Branch":"Create New Branch"}),e.jsxs("form",{onSubmit:N(p),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Name *"}),e.jsx("input",{type:"text",...i("name",{required:"Branch name is required"}),placeholder:"e.g., Main Location, Downtown Campus",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t}),u.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",...i("address"),placeholder:"123 Main St, City, State",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...i("phone"),placeholder:"(555) 123-4567",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{...i("description"),placeholder:"Additional details about this branch...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:f,disabled:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition",children:t?"Saving...":r?"Update":"Create"})]})]})]})})})}function X(){const a=L(),{branches:n,setBranches:y,addBranch:j,updateBranch:r,removeBranch:t,isLoading:h,setLoading:i}=A(),[N,c]=x.useState(!1),[u,p]=x.useState(void 0),[f,l]=x.useState(null);x.useEffect(()=>{a.church?.id&&d()},[a.church?.id]);const d=async()=>{if(a.church?.id){i(!0);try{const s=await P(a.church.id);y(s)}catch(s){console.error("Failed to load branches:",s),o.error("Failed to load branches")}finally{i(!1)}}},g=()=>{p(void 0),c(!0)},C=s=>{p(s),c(!0)},k=s=>{u?r(s.id,s):j(s)},D=async s=>{if(window.confirm("Are you sure you want to delete this branch? This action cannot be undone.")){l(s);try{const m=await q(s);t(s),o.success(`Branch deleted. ${m.groupsDeleted} group(s) and ${m.membersDeleted} member(s) were removed.`)}catch(m){const M=m.response?.data?.error||"Failed to delete branch";o.error(M)}finally{l(null)}}};return h&&n.length===0?e.jsx(w,{children:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(v.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(_,{className:"w-8 h-8 text-primary"})})})}):e.jsxs(w,{children:[e.jsx(O,{variant:"minimal"}),e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between mb-8 flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Branches"})}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your church locations"})]}),e.jsx(b,{variant:"primary",size:"lg",onClick:g,children:"New Branch"})]}),n.length===0?e.jsxs(B,{className:"text-center py-16",children:[e.jsx("div",{className:"mb-6",children:e.jsx(S,{className:"w-16 h-16 text-muted-foreground/50 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"No Branches Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Create your first branch to start managing your church locations and organizing your congregation."}),e.jsx(b,{variant:"primary",onClick:g,children:"Create Your First Branch"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map((s,m)=>e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.05},children:e.jsxs(B,{variant:"default",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-2",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-border/40",children:[s.address&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(S,{className:"w-4 h-4 inline mr-2"}),s.address]}),s.phone&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ“ž ",s.phone]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.groupCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Groups"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.memberCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Members"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(b,{variant:"secondary",onClick:()=>C(s),fullWidth:!0,children:[e.jsx(I,{className:"w-4 h-4"}),"Edit"]}),e.jsxs(b,{variant:"danger",onClick:()=>D(s.id),disabled:f===s.id||n.length===1,fullWidth:!0,children:[e.jsx(W,{className:"w-4 h-4"}),f===s.id?"Deleting...":"Delete"]})]})]})},s.id))})]}),e.jsx($,{isOpen:N,onClose:()=>c(!1),onSuccess:k,churchId:a.church?.id||"",branch:u})]})}export{X as BranchesPage,X as default};
//# sourceMappingURL=BranchesPage-Cz-sKaTj.js.map
