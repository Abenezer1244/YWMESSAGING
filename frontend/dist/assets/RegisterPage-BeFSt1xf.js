import{u as y,a as k,r as g,f as C,j as e,C as S,I as l,B as R,L as P,_ as t,b as q}from"./index-DIob0B3d.js";import{u as L}from"./index.esm-Bwfu8fue.js";import{B as z}from"./BackButton-Dgcn4w9R.js";import{A as M}from"./AnimatedBlobs-BWkkb2tj.js";import"./proxy-CfsthMKV.js";function F(){const x=y(),{setAuth:p}=k(),[s,u]=g.useState(!1);g.useEffect(()=>{C().catch(()=>{console.warn("Failed to fetch CSRF token, registration may fail")})},[]);const{register:o,handleSubmit:b,watch:f,formState:{errors:i}}=L({defaultValues:{email:"",password:"",confirmPassword:"",firstName:"",lastName:"",churchName:""}});f("password");const N=async r=>{if(r.password!==r.confirmPassword){t.error("Passwords do not match");return}u(!0);try{const d=await q({email:r.email,password:r.password,firstName:r.firstName,lastName:r.lastName,churchName:r.churchName}),{admin:a,church:n,accessToken:c,refreshToken:m}=d.data;console.log("Registration successful, setting auth:",{admin:a,church:n,accessToken:c?"present":"missing"}),p(a,n,c,m),t.success("Registration successful!"),setTimeout(()=>{console.log("Navigating to dashboard"),x("/dashboard",{replace:!0})},100)}catch(d){if(u(!1),d.response?.status===429){const a=d.response?.headers?.["ratelimit-reset"];if(a){const n=parseInt(a)*1e3,c=Date.now(),m=Math.ceil((n-c)/1e3),h=Math.ceil(m/60),w=`Too many registration attempts. Please try again in ${h} minute${h>1?"s":""}.`;t.error(w,{duration:5e3})}else t.error("Too many registration attempts. Please try again in 1 hour.")}else{const a=d.response?.data?.error||"Registration failed. Please try again.";t.error(a)}}},j=()=>{t.loading("Redirecting to Google Sign Up...")},v=()=>{t.loading("Redirecting to Apple Sign Up...")};return e.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 py-8 relative overflow-hidden",children:[e.jsx(M,{variant:"minimal"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-primary opacity-10 rounded-full blur-3xl pointer-events-none"}),e.jsxs("div",{className:"w-full max-w-2xl relative z-10 animate-fadeIn",children:[e.jsx("div",{className:"mb-6",children:e.jsx(z,{variant:"ghost",size:"sm"})}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("img",{src:"/logo.svg",alt:"Koinonia",className:"w-16 h-16 hover:opacity-80 transition-opacity"})}),e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-3 tracking-tight",children:"Create Your Account"}),e.jsx("p",{className:"text-lg text-muted-foreground font-light",children:"Start your 14-day free trial • No credit card required"})]}),e.jsxs(S,{variant:"default",className:"p-8 border border-border bg-card shadow-lg",children:[e.jsxs("form",{onSubmit:b(N),className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{label:"First Name",placeholder:"John",disabled:s,error:i.firstName?.message,className:"bg-muted border-border text-foreground",...o("firstName",{required:"First name is required"})}),e.jsx(l,{label:"Last Name",placeholder:"Doe",disabled:s,error:i.lastName?.message,className:"bg-muted border-border text-foreground",...o("lastName",{required:"Last name is required"})})]}),e.jsx(l,{label:"Church Name",placeholder:"Grace Community Church",disabled:s,error:i.churchName?.message,className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...o("churchName",{required:"Church name is required"})}),e.jsx(l,{label:"Email Address",type:"email",placeholder:"pastor@church.com",disabled:s,error:i.email?.message,className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...o("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}})}),e.jsx(l,{label:"Password",type:"password",placeholder:"••••••••",helperText:"Must be at least 8 characters",disabled:s,error:i.password?.message,className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...o("password",{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"}})}),e.jsx(l,{label:"Confirm Password",type:"password",placeholder:"••••••••",disabled:s,error:i.confirmPassword?.message,className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...o("confirmPassword",{required:"Please confirm your password"})}),e.jsx(R,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,isLoading:s,disabled:s,className:"font-semibold mt-6 bg-primary hover:bg-primary/90 text-background",children:s?"Creating account...":"Create Account"})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-border",children:[e.jsx("p",{className:"text-center text-muted-foreground text-xs font-medium uppercase tracking-wider mb-6",children:"Or sign up with"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:j,disabled:s,className:"flex items-center justify-center gap-2 px-4 py-3 rounded-lg border border-border bg-card hover:bg-muted transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium text-sm",children:[e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6z",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})}),e.jsx("span",{children:"Google"})]}),e.jsxs("button",{type:"button",onClick:v,disabled:s,className:"flex items-center justify-center gap-2 px-4 py-3 rounded-lg border border-border bg-card hover:bg-muted transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium text-sm",children:[e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.05 13.5c-.91 0-1.82-.55-2.25-1.52-.1-.23-.37-.23-.47 0-.43.97-1.34 1.52-2.25 1.52-1.51 0-2.73-1.22-2.73-2.73 0-1.51 1.22-2.73 2.73-2.73.91 0 1.82.55 2.25 1.52.1.23.37.23.47 0 .43-.97 1.34-1.52 2.25-1.52 1.51 0 2.73 1.22 2.73 2.73 0 1.51-1.22 2.73-2.73 2.73m-5-9c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1m8 0c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1m-4 15c-5.52 0-10-4.48-10-10S2.48 2 8 2s10 4.48 10 10-4.48 10-10 10m0-18C4.48 2 1 5.48 1 10s3.48 8 7 8 8-3.48 8-8-3.48-8-8-8"})}),e.jsx("span",{children:"Apple"})]})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-border",children:e.jsxs("p",{className:"text-center text-muted-foreground text-sm",children:["Already have an account?"," ",e.jsx(P,{to:"/login",className:"text-primary hover:text-primary/80 font-semibold transition-colors",children:"Login here"})]})})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-success-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"Setup in Minutes"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-success-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"Secure & Reliable"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-success-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"No Card Required"})]})]})]})]})}export{F as RegisterPage,F as default};
//# sourceMappingURL=RegisterPage-BeFSt1xf.js.map
