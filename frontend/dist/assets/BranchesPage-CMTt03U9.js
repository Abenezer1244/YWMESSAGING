import{r as m,j as e,_ as o,d as S,e as k,a as E,c as z,g as F,S as M,B as b,C as v,h as A}from"./index-Coc3MG9e.js";import{u as L}from"./index.esm-tsqnUglz.js";import{B as q}from"./BackButton-BrTS8WUC.js";function O({isOpen:a,onClose:n,onSuccess:j,churchId:y,branch:r}){const[t,x]=m.useState(!1),{register:d,handleSubmit:N,reset:c,formState:{errors:u}}=L({defaultValues:{name:r?.name||"",address:r?.address||"",phone:r?.phone||"",description:r?.description||""}});if(!a)return null;const h=async l=>{if(!l.name||!l.name.trim()){o.error("Branch name is required");return}x(!0);try{let i;r?(i=await S(r.id,l),o.success("Branch updated successfully")):(i=await k(y,l),o.success("Branch created successfully")),c(),j(i),n()}catch(i){const p=i.response?.data?.error||"Failed to save branch";o.error(p)}finally{x(!1)}},g=()=>{c(),n()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:r?"Edit Branch":"Create New Branch"}),e.jsxs("form",{onSubmit:N(h),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Name *"}),e.jsx("input",{type:"text",...d("name",{required:"Branch name is required"}),placeholder:"e.g., Main Location, Downtown Campus",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t}),u.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",...d("address"),placeholder:"123 Main St, City, State",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...d("phone"),placeholder:"(555) 123-4567",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{...d("description"),placeholder:"Additional details about this branch...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:t})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:g,disabled:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition",children:t?"Saving...":r?"Update":"Create"})]})]})]})})})}function _(){const a=E(),{branches:n,setBranches:j,addBranch:y,updateBranch:r,removeBranch:t,isLoading:x,setLoading:d}=z(),[N,c]=m.useState(!1),[u,h]=m.useState(void 0),[g,l]=m.useState(null);m.useEffect(()=>{a.church?.id&&i()},[a.church?.id]);const i=async()=>{if(a.church?.id){d(!0);try{const s=await F(a.church.id);j(s)}catch(s){console.error("Failed to load branches:",s),o.error("Failed to load branches")}finally{d(!1)}}},p=()=>{h(void 0),c(!0)},B=s=>{h(s),c(!0)},w=s=>{u?r(s.id,s):y(s)},C=async s=>{if(window.confirm("Are you sure you want to delete this branch? This action cannot be undone.")){l(s);try{const f=await A(s);t(s),o.success(`Branch deleted. ${f.groupsDeleted} group(s) and ${f.membersDeleted} member(s) were removed.`)}catch(f){const D=f.response?.data?.error||"Failed to delete branch";o.error(D)}finally{l(null)}}};return x&&n.length===0?e.jsx("div",{className:"min-h-screen bg-background p-6 flex items-center justify-center",children:e.jsx(M,{size:"lg",text:"Loading branches..."})}):e.jsxs("div",{className:"min-h-screen bg-background p-6 transition-colors duration-normal",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsx(q,{variant:"ghost"})}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"ðŸ“ Branches"}),e.jsx("p",{className:"text-foreground/80",children:"Manage your church locations"})]}),e.jsx(b,{variant:"primary",size:"lg",onClick:p,children:"+ New Branch"})]}),n.length===0?e.jsxs(v,{variant:"highlight",className:"text-center py-16 bg-muted border-border",children:[e.jsx("div",{className:"mb-6",children:e.jsx("span",{className:"text-6xl",children:"ðŸ“"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"No Branches Yet"}),e.jsx("p",{className:"text-foreground/80 mb-6 max-w-md mx-auto",children:"Create your first branch to start managing your church locations and organizing your congregation."}),e.jsx(b,{variant:"primary",size:"md",onClick:p,children:"Create Your First Branch"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(s=>e.jsxs(v,{variant:"default",className:"hover:shadow-lg transition-shadow bg-muted border-border",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-2",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-foreground/80",children:s.description})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-border",children:[s.address&&e.jsxs("p",{className:"text-sm text-foreground/80",children:[e.jsx("span",{className:"font-medium",children:"ðŸ“"})," ",s.address]}),s.phone&&e.jsxs("p",{className:"text-sm text-foreground/80",children:[e.jsx("span",{className:"font-medium",children:"ðŸ“ž"})," ",s.phone]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.groupCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Groups"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.memberCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Members"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"secondary",size:"sm",onClick:()=>B(s),fullWidth:!0,children:"Edit"}),e.jsx(b,{variant:"danger",size:"sm",onClick:()=>C(s.id),disabled:g===s.id||n.length===1,fullWidth:!0,children:g===s.id?"Deleting...":"Delete"})]})]},s.id))})]}),e.jsx(O,{isOpen:N,onClose:()=>c(!1),onSuccess:w,churchId:a.church?.id||"",branch:u})]})}export{_ as BranchesPage,_ as default};
//# sourceMappingURL=BranchesPage-CMTt03U9.js.map
