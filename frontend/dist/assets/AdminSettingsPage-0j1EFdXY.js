import{n as f,r as i,_ as l,j as e,I as v}from"./index-Dqt43-1K.js";import{a as A,S as w,L}from"./SoftLayout-DKq3KgHa.js";import{S as D}from"./SoftButton-Ct-JgzCc.js";import{m as c}from"./proxy-DUSIY0-W.js";async function P(){return(await f.get("/admin/profile")).data}async function I(t){return(await f.put("/admin/profile",t)).data}async function k(){return(await f.get("/admin/co-admins")).data}async function E(t){return(await f.post("/admin/co-admins",t)).data}async function F(t){return(await f.delete(`/admin/co-admins/${t}`)).data}async function R(t=1,d=50){return(await f.get("/admin/activity-logs",{params:{page:t,limit:d}})).data}function T(){const[t,d]=i.useState([]),[h,x]=i.useState(!0),[r,u]=i.useState(null),[m,o]=i.useState(!1),[n,y]=i.useState(!1),[g,j]=i.useState(null),[a,p]=i.useState({email:"",firstName:"",lastName:""});i.useEffect(()=>{N()},[]);const N=async()=>{try{x(!0);const s=await k();d(s)}catch(s){l.error(s.message||"Failed to load co-admins")}finally{x(!1)}},C=async s=>{if(confirm("Are you sure you want to remove this co-admin? They will lose access immediately."))try{u(s),await F(s),l.success("Co-admin removed successfully"),N()}catch(b){l.error(b.message||"Failed to remove co-admin")}finally{u(null)}},S=async s=>{if(s.preventDefault(),!a.email||!a.firstName||!a.lastName){l.error("Please fill in all fields");return}try{y(!0);const b=await E({email:a.email,firstName:a.firstName,lastName:a.lastName});j(b.data),p({email:"",firstName:"",lastName:""}),l.success("Co-admin invited successfully"),N()}catch(b){l.error(b.message||"Failed to invite co-admin")}finally{y(!1)}};return h?e.jsx("p",{className:"text-gray-500",children:"Loading co-admins..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Co-Admin Management"}),e.jsx("button",{onClick:()=>o(!m),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition",children:m?"Cancel":"Invite Co-Admin"})]}),m&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Invite New Co-Admin"}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),e.jsx("input",{type:"text",value:a.firstName,onChange:s=>p({...a,firstName:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"John",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",value:a.lastName,onChange:s=>p({...a,lastName:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"Doe",disabled:n})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:a.email,onChange:s=>p({...a,email:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"john.doe@example.com",disabled:n})]}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold py-2 px-4 rounded-lg transition",children:n?"Inviting...":"Send Invite"})]})]}),g&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-4",children:"Co-Admin Invited Successfully!"}),e.jsxs("p",{className:"text-sm text-green-800 mb-4",children:["Share the following credentials with ",e.jsx("strong",{children:g.admin.email}),":"]}),e.jsxs("div",{className:"bg-white border border-green-300 rounded p-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[e.jsx("strong",{children:"Email:"})," ",g.admin.email]}),e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[e.jsx("strong",{children:"Temporary Password:"}),e.jsx("code",{className:"ml-2 bg-gray-100 px-2 py-1 rounded font-mono text-green-700",children:g.tempPassword}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(g.tempPassword),l.success("Password copied to clipboard")},className:"ml-2 text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Copy"})]})]}),e.jsx("p",{className:"text-sm text-green-700 mb-4",children:"They can log in with this temporary password and change it after first login."}),e.jsx("button",{onClick:()=>j(null),className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition",children:"Done"})]}),t.length===0?e.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-gray-600",children:"No co-admins yet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:'Click "Invite Co-Admin" to add your first co-admin'})]}):e.jsx("div",{className:"overflow-x-auto mb-6",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Added"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Last Login"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:t.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.email}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.lastLoginAt?new Date(s.lastLoginAt).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("button",{onClick:()=>C(s.id),disabled:r===s.id,className:"text-red-600 hover:text-red-700 disabled:opacity-50 font-medium",children:r===s.id?"Removing...":"Remove"})})]},s.id))})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," Co-admins can manage branches, groups, members, and messages. They cannot manage billing or other co-admins."]})})]})}function M(){const[t,d]=i.useState(null),[h,x]=i.useState(!0),[r,u]=i.useState(1);i.useEffect(()=>{m()},[r]);const m=async()=>{try{x(!0);const o=await R(r,50);d(o)}catch(o){l.error(o.message||"Failed to load activity logs")}finally{x(!1)}};return h?e.jsx("p",{className:"text-gray-500",children:"Loading activity logs..."}):!t||t.logs.length===0?e.jsx("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No activity logs yet"})}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Activity Logs"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Action"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Admin"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Timestamp"})]})}),e.jsx("tbody",{className:"divide-y",children:t.logs.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:o.action}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:o.details}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:o.adminEmail}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(o.timestamp).toLocaleString()})]},o.id))})]})}),t.pagination.pages>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(r-1)*t.pagination.limit+1," to"," ",Math.min(r*t.pagination.limit,t.pagination.total)," of"," ",t.pagination.total," logs"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(Math.max(1,r-1)),disabled:r===1,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("div",{className:"px-4 py-2 border border-gray-300 rounded-lg bg-gray-50",children:["Page ",r," of ",t.pagination.pages]}),e.jsx("button",{onClick:()=>u(Math.min(t.pagination.pages,r+1)),disabled:r===t.pagination.pages,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["ðŸ“‹ ",e.jsx("strong",{children:"Activity logs:"})," All user actions are logged for security and compliance purposes. Logs are retained for 90 days."]})})]})}const $=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t);function V(){const[t,d]=i.useState("profile"),[h,x]=i.useState(!1),[r,u]=i.useState(!1),[m,o]=i.useState(null),[n,y]=i.useState({name:"",email:""}),g=async()=>{try{x(!0);const a=await P();o(a),y({name:a.name||"",email:a.email||""})}catch{l.error("Failed to load profile. Please refresh the page.")}finally{x(!1)}},j=async a=>{if(a.preventDefault(),!n.name.trim()){l.error("Church name is required");return}if(!n.email.trim()){l.error("Email address is required");return}if(!$(n.email.trim())){l.error("Please enter a valid email address");return}try{u(!0),await I({name:n.name.trim(),email:n.email.trim()}),l.success("Profile updated successfully"),g()}catch{l.error("Failed to update profile. Please try again.")}finally{u(!1)}};return e.jsx(A,{children:e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Settings"})}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your church account and permissions"})]}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"mb-8",children:e.jsxs(w,{children:[e.jsx("div",{className:"border-b border-border/40",children:e.jsx("div",{className:"flex flex-wrap",children:["profile","coadmins","logs"].map((a,p)=>e.jsxs(c.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:p*.05},onClick:()=>d(a),className:`flex-1 min-w-[120px] px-4 py-4 text-center font-medium border-b-2 transition ${t===a?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[a==="profile"&&"Church Profile",a==="coadmins"&&"Co-Admins",a==="logs"&&"Activity Logs"]},a))})}),e.jsxs("div",{className:"p-8",children:[t==="profile"&&e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-6",children:"Church Profile"}),h?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(c.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(L,{className:"w-8 h-8 text-primary"})})}):e.jsxs("form",{onSubmit:j,className:"max-w-2xl",children:[e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6",children:e.jsx(v,{label:"Church Name",type:"text",value:n.name,onChange:a=>y({...n,name:a.target.value}),placeholder:"Your church name"})}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"mb-6",children:e.jsx(v,{label:"Email Address",type:"email",value:n.email,onChange:a=>y({...n,email:a.target.value}),placeholder:"contact@church.com"})}),m&&e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-6",children:e.jsxs(w,{variant:"gradient",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-3",children:"Account Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"})," ",e.jsx("span",{className:"font-medium text-foreground",children:m.subscriptionStatus})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"})," ",e.jsx("span",{className:"font-medium text-foreground",children:new Date(m.createdAt).toLocaleDateString()})]})]})]})}),e.jsx(D,{type:"submit",variant:"primary",disabled:r,children:r?"Saving...":"Save Changes"})]})]}),t==="coadmins"&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx(T,{})}),t==="logs"&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx(M,{})})]})]})})]})})}export{V as AdminSettingsPage,V as default};
//# sourceMappingURL=AdminSettingsPage-0j1EFdXY.js.map
