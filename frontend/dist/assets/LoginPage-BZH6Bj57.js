import{u as p,a as t,r as l,f as y,j as e,C as b,I as m,B as j,L as k,l as v,_ as u}from"./index-D-3FiYPt.js";import{u as N}from"./index.esm-DRKgdTb_.js";function S(){const h=p(),{setAuth:g}=t(),[r,n]=l.useState(!1);l.useEffect(()=>{y().catch(()=>{console.warn("Failed to fetch CSRF token, login may fail")})},[]);const{register:i,handleSubmit:x,formState:{errors:c}}=N({defaultValues:{email:"",password:""}}),f=async d=>{n(!0);try{console.log("Starting login with:",d.email);const a=await v(d);console.log("Login response:",a),console.log("response.data keys:",Object.keys(a.data));const{admin:s,church:o}=a.data;console.log("Extracted admin and church:",{admin:s,church:o,adminIsNull:s===null,adminIsUndefined:s===void 0}),console.log("Login successful, setting auth:",{admin:s,church:o,accessToken:a.data.accessToken?"present":"missing"}),g(s,o,a.data.accessToken,a.data.refreshToken),console.log("After setAuth, checking store:",{isAuthenticated:t.getState().isAuthenticated,user:t.getState().user,church:t.getState().church}),console.log("Navigating to dashboard"),h("/dashboard",{replace:!0}),u.success("Login successful!")}catch(a){console.error("Login error:",a);const s=a.response?.data?.error||"Login failed. Please try again.";u.error(s),n(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 dark:from-secondary-900 via-white dark:via-secondary-950 to-primary-100 dark:to-secondary-900 flex items-center justify-center p-4 transition-colors duration-normal",children:e.jsxs("div",{className:"w-full max-w-md animate-fadeIn",children:[e.jsxs(b,{variant:"default",className:"p-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-primary-600 dark:from-primary-500 to-primary-700 dark:to-primary-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white font-bold text-2xl",children:"YW"})})}),e.jsx("h1",{className:"text-3xl font-bold text-center mb-2 text-secondary-900 dark:text-secondary-50",children:"Welcome Back"}),e.jsx("p",{className:"text-center text-secondary-600 dark:text-secondary-400 mb-8",children:"Church SMS Communication Platform"}),e.jsxs("form",{onSubmit:x(f),className:"space-y-5",children:[e.jsx(m,{label:"Email Address",type:"email",placeholder:"pastor@church.com",disabled:r,error:c.email?.message,...i("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}})}),e.jsx(m,{label:"Password",type:"password",placeholder:"••••••••",disabled:r,error:c.password?.message,...i("password",{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"}})}),e.jsx(j,{type:"submit",variant:"primary",size:"md",fullWidth:!0,isLoading:r,disabled:r,children:r?"Logging in...":"Login"})]}),e.jsx("div",{className:"mt-8 pt-8 border-t border-secondary-200 dark:border-secondary-700",children:e.jsxs("p",{className:"text-center text-secondary-600 dark:text-secondary-400",children:["Don't have an account?"," ",e.jsx(k,{to:"/register",className:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-semibold transition-colors",children:"Create account"})]})})]}),e.jsx("div",{className:"mt-8 text-center text-sm text-secondary-600 dark:text-secondary-400",children:e.jsx("p",{children:"14-day free trial • No credit card required"})})]})})}export{S as LoginPage,S as default};
//# sourceMappingURL=LoginPage-BZH6Bj57.js.map
