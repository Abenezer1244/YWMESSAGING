import{r as c,j as e,C as b,B as d,_ as l}from"./index-D-3FiYPt.js";import{u as M}from"./groupStore-BX0kzEJq.js";import{u as F,s as E}from"./messages-BIYeM4YU.js";import{g as z,T as G}from"./TemplateFormModal-Cn22bANz.js";import"./index.esm-DRKgdTb_.js";function U(){const{groups:x}=M(),{addMessage:k}=F(),[t,i]=c.useState(""),[a,y]=c.useState("groups"),[r,u]=c.useState([]),[m,g]=c.useState(!1),[p,N]=c.useState([]),[v,j]=c.useState(!1);c.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await z();N(s)}catch(s){console.error("Failed to load templates:",s)}},n=Math.ceil(t.length/160)||0,C=n*r.length*.0075,S=r.reduce((s,o)=>s+(x.find(h=>h.id===o)?.memberCount||0),0),w=s=>{u(o=>o.includes(s)?o.filter(h=>h!==s):[...o,s])},D=s=>{i(s.content),l.success(`Using template: ${s.name}`)},T=async()=>{if(!t.trim()){l.error("Please enter a message");return}if(a==="groups"&&r.length===0){l.error("Please select at least one group");return}try{g(!0);const s=await E({content:t.trim(),targetType:a==="all"?"all":"groups",targetIds:a==="all"?void 0:r});k(s),l.success(`Message queued for ${s.totalRecipients} recipients`),i(""),u([])}catch(s){l.error(s.message||"Failed to send message")}finally{g(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-secondary-50 dark:from-secondary-900 to-secondary-100 dark:to-secondary-950 p-6 transition-colors duration-normal",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-secondary-900 dark:text-secondary-50 mb-2",children:"📨 Send Message"}),e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Reach your congregation with direct SMS messages"})]})}),e.jsxs(b,{variant:"default",className:"space-y-6",children:[p.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary-900 dark:text-secondary-50 mb-3",children:"📋 Use Template"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[p.slice(0,6).map(s=>e.jsx(d,{variant:"secondary",size:"sm",onClick:()=>D(s),title:s.content,children:s.name},s.id)),p.length>6&&e.jsx(d,{variant:"outline",size:"sm",onClick:()=>window.location.href="/templates",children:"More Templates..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary-900 dark:text-secondary-50 mb-3",children:"✍️ Message Content"}),e.jsx("textarea",{value:t,onChange:s=>i(s.target.value.slice(0,1600)),className:"w-full px-4 py-3 border border-secondary-200 dark:border-secondary-700 rounded-lg bg-white dark:bg-secondary-800 text-secondary-900 dark:text-secondary-50 placeholder-secondary-400 dark:placeholder-secondary-500 focus:outline-none focus:ring-2 focus:ring-primary-500 resize-none transition-colors duration-normal",rows:6,placeholder:"Type your message here...",maxLength:1600}),e.jsxs("div",{className:"flex justify-between mt-3 text-sm text-secondary-600 dark:text-secondary-400",children:[e.jsxs("span",{children:[t.length," / 1600 characters"]}),e.jsxs("span",{children:[n," SMS segment",n!==1?"s":"",n>0&&` ($${(n*.0075).toFixed(4)} per recipient)`]})]}),t.trim()&&e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>j(!0),className:"mt-2",children:"💾 Save as Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-secondary-900 dark:text-secondary-50 mb-3",children:"👥 Send To"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"radio",name:"targetType",value:"groups",checked:a==="groups",onChange:s=>y(s.target.value),className:"w-4 h-4 accent-primary-600 dark:accent-primary-400 cursor-pointer"}),e.jsx("span",{className:"text-sm font-medium text-secondary-900 dark:text-secondary-50",children:"Select Groups"})]}),a==="groups"&&e.jsx("div",{className:"ml-7 space-y-2 bg-secondary-100 dark:bg-secondary-800 p-4 rounded-lg border border-secondary-200 dark:border-secondary-700",children:x.length===0?e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 text-sm",children:"No groups available"}):x.map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:r.includes(s.id),onChange:()=>w(s.id),className:"w-4 h-4 rounded accent-primary-600 dark:accent-primary-400 cursor-pointer"}),e.jsxs("span",{className:"text-sm text-secondary-700 dark:text-secondary-300",children:[s.name," (",s.memberCount," members)"]})]},s.id))}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"radio",name:"targetType",value:"all",checked:a==="all",onChange:s=>y(s.target.value),className:"w-4 h-4 accent-primary-600 dark:accent-primary-400 cursor-pointer"}),e.jsx("span",{className:"text-sm font-medium text-secondary-900 dark:text-secondary-50",children:"All Members"})]})]})]}),(a==="all"||r.length>0)&&n>0&&e.jsx(b,{variant:"highlight",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary-700 dark:text-secondary-300",children:"Recipients:"}),e.jsx("span",{className:"font-medium text-secondary-900 dark:text-secondary-50",children:S})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary-700 dark:text-secondary-300",children:"Segments:"}),e.jsx("span",{className:"font-medium text-secondary-900 dark:text-secondary-50",children:n})]}),e.jsxs("div",{className:"flex justify-between border-t border-primary-200 dark:border-primary-700 pt-2",children:[e.jsx("span",{className:"font-medium text-secondary-900 dark:text-secondary-50",children:"Estimated Cost:"}),e.jsxs("span",{className:"font-bold text-primary-600 dark:text-primary-400",children:["$",C.toFixed(2)]})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(d,{variant:"secondary",size:"md",onClick:()=>{i(""),u([])},disabled:m,children:"🗑️ Clear"}),e.jsx(d,{variant:"primary",size:"md",fullWidth:!0,onClick:T,disabled:m||!t.trim()||a==="groups"&&r.length===0,isLoading:m,children:m?"Sending...":"✉️ Send Message"})]})]})]}),v&&e.jsx(G,{template:null,onClose:()=>{j(!1),f()}})]})}export{U as SendMessagePage,U as default};
//# sourceMappingURL=SendMessagePage-qxsIGRf0.js.map
