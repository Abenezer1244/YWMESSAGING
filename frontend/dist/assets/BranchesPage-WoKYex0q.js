import{r as m,j as e,_ as c,d as S,e as k,a as E,c as z,g as F,S as M,B as f,C as v,h as A}from"./index-BA_iw0u3.js";import{u as L}from"./index.esm-BraODQNm.js";import{B as q}from"./BackButton-C0FERsXn.js";function O({isOpen:r,onClose:n,onSuccess:j,churchId:y,branch:t}){const[a,x]=m.useState(!1),{register:l,handleSubmit:N,reset:o,formState:{errors:u}}=L({defaultValues:{name:t?.name||"",address:t?.address||"",phone:t?.phone||"",description:t?.description||""}});if(!r)return null;const h=async i=>{if(!i.name||!i.name.trim()){c.error("Branch name is required");return}x(!0);try{let d;t?(d=await S(t.id,i),c.success("Branch updated successfully")):(d=await k(y,i),c.success("Branch created successfully")),o(),j(d),n()}catch(d){const g=d.response?.data?.error||"Failed to save branch";c.error(g)}finally{x(!1)}},p=()=>{o(),n()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:t?"Edit Branch":"Create New Branch"}),e.jsxs("form",{onSubmit:N(h),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Name *"}),e.jsx("input",{type:"text",...l("name",{required:"Branch name is required"}),placeholder:"e.g., Main Location, Downtown Campus",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a}),u.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",...l("address"),placeholder:"123 Main St, City, State",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...l("phone"),placeholder:"(555) 123-4567",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{...l("description"),placeholder:"Additional details about this branch...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:p,disabled:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition",children:a?"Saving...":t?"Update":"Create"})]})]})]})})})}function _(){const r=E(),{branches:n,setBranches:j,addBranch:y,updateBranch:t,removeBranch:a,isLoading:x,setLoading:l}=z(),[N,o]=m.useState(!1),[u,h]=m.useState(void 0),[p,i]=m.useState(null);m.useEffect(()=>{r.church?.id&&d()},[r.church?.id]);const d=async()=>{if(r.church?.id){l(!0);try{const s=await F(r.church.id);j(s)}catch(s){console.error("Failed to load branches:",s),c.error("Failed to load branches")}finally{l(!1)}}},g=()=>{h(void 0),o(!0)},B=s=>{h(s),o(!0)},w=s=>{u?t(s.id,s):y(s)},C=async s=>{if(window.confirm("Are you sure you want to delete this branch? This action cannot be undone.")){i(s);try{const b=await A(s);a(s),c.success(`Branch deleted. ${b.groupsDeleted} group(s) and ${b.membersDeleted} member(s) were removed.`)}catch(b){const D=b.response?.data?.error||"Failed to delete branch";c.error(D)}finally{i(null)}}};return x&&n.length===0?e.jsx("div",{className:"min-h-screen bg-slate-950 p-6 flex items-center justify-center",children:e.jsx(M,{size:"lg",text:"Loading branches..."})}):e.jsxs("div",{className:"min-h-screen bg-slate-950 p-6 transition-colors duration-normal",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsx(q,{variant:"ghost"})}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"ðŸ“ Branches"}),e.jsx("p",{className:"text-slate-300",children:"Manage your church locations"})]}),e.jsx(f,{variant:"primary",size:"lg",onClick:g,children:"+ New Branch"})]}),n.length===0?e.jsxs(v,{variant:"highlight",className:"text-center py-16 bg-slate-900/50 border-slate-700",children:[e.jsx("div",{className:"mb-6",children:e.jsx("span",{className:"text-6xl",children:"ðŸ“"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"No Branches Yet"}),e.jsx("p",{className:"text-slate-300 mb-6 max-w-md mx-auto",children:"Create your first branch to start managing your church locations and organizing your congregation."}),e.jsx(f,{variant:"primary",size:"md",onClick:g,children:"Create Your First Branch"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(s=>e.jsxs(v,{variant:"default",className:"hover:shadow-lg transition-shadow bg-slate-900/50 border-slate-700",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-slate-300",children:s.description})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-slate-700",children:[s.address&&e.jsxs("p",{className:"text-sm text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"ðŸ“"})," ",s.address]}),s.phone&&e.jsxs("p",{className:"text-sm text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"ðŸ“ž"})," ",s.phone]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-accent-400",children:s.groupCount}),e.jsx("p",{className:"text-xs text-slate-400 uppercase",children:"Groups"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-accent-400",children:s.memberCount}),e.jsx("p",{className:"text-xs text-slate-400 uppercase",children:"Members"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>B(s),fullWidth:!0,children:"Edit"}),e.jsx(f,{variant:"danger",size:"sm",onClick:()=>C(s.id),disabled:p===s.id||n.length===1,fullWidth:!0,children:p===s.id?"Deleting...":"Delete"})]})]},s.id))})]}),e.jsx(O,{isOpen:N,onClose:()=>o(!1),onSuccess:w,churchId:r.church?.id||"",branch:u})]})}export{_ as BranchesPage,_ as default};
//# sourceMappingURL=BranchesPage-WoKYex0q.js.map
