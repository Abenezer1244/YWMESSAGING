import{r as u,j as e,_ as c,d as D,e as S,a as E,c as z,g as F,S as M,B as f,C as v,h as A}from"./index-C_1TKi-h.js";import{u as L}from"./index.esm-c-QvmoYu.js";function q({isOpen:t,onClose:n,onSuccess:b,churchId:j,branch:r}){const[a,x]=u.useState(!1),{register:d,handleSubmit:N,reset:o,formState:{errors:m}}=L({defaultValues:{name:r?.name||"",address:r?.address||"",phone:r?.phone||"",description:r?.description||""}});if(!t)return null;const h=async i=>{if(!i.name||!i.name.trim()){c.error("Branch name is required");return}x(!0);try{let l;r?(l=await D(r.id,i),c.success("Branch updated successfully")):(l=await S(j,i),c.success("Branch created successfully")),o(),b(l),n()}catch(l){const g=l.response?.data?.error||"Failed to save branch";c.error(g)}finally{x(!1)}},p=()=>{o(),n()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:r?"Edit Branch":"Create New Branch"}),e.jsxs("form",{onSubmit:N(h),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Name *"}),e.jsx("input",{type:"text",...d("name",{required:"Branch name is required"}),placeholder:"e.g., Main Location, Downtown Campus",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a}),m.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",...d("address"),placeholder:"123 Main St, City, State",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...d("phone"),placeholder:"(555) 123-4567",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{...d("description"),placeholder:"Additional details about this branch...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:a})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:p,disabled:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition",children:a?"Saving...":r?"Update":"Create"})]})]})]})})})}function W(){const t=E(),{branches:n,setBranches:b,addBranch:j,updateBranch:r,removeBranch:a,isLoading:x,setLoading:d}=z(),[N,o]=u.useState(!1),[m,h]=u.useState(void 0),[p,i]=u.useState(null);u.useEffect(()=>{t.church?.id&&l()},[t.church?.id]);const l=async()=>{if(t.church?.id){d(!0);try{const s=await F(t.church.id);b(s)}catch(s){console.error("Failed to load branches:",s),c.error("Failed to load branches")}finally{d(!1)}}},g=()=>{h(void 0),o(!0)},B=s=>{h(s),o(!0)},k=s=>{m?r(s.id,s):j(s)},w=async s=>{if(window.confirm("Are you sure you want to delete this branch? This action cannot be undone.")){i(s);try{const y=await A(s);a(s),c.success(`Branch deleted. ${y.groupsDeleted} group(s) and ${y.membersDeleted} member(s) were removed.`)}catch(y){const C=y.response?.data?.error||"Failed to delete branch";c.error(C)}finally{i(null)}}};return x&&n.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 dark:from-primary-900 to-primary-100 dark:to-primary-950 p-6 flex items-center justify-center",children:e.jsx(M,{size:"lg",text:"Loading branches..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 dark:from-primary-900 to-primary-100 dark:to-primary-950 p-6 transition-colors duration-normal",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-primary-900 dark:text-primary-50 mb-2",children:"ðŸ“ Branches"}),e.jsx("p",{className:"text-primary-600 dark:text-primary-400",children:"Manage your church locations"})]}),e.jsx(f,{variant:"primary",size:"lg",onClick:g,children:"+ New Branch"})]}),n.length===0?e.jsxs(v,{variant:"highlight",className:"text-center py-16",children:[e.jsx("div",{className:"mb-6",children:e.jsx("span",{className:"text-6xl",children:"ðŸ“"})}),e.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-secondary-50 mb-3",children:"No Branches Yet"}),e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6 max-w-md mx-auto",children:"Create your first branch to start managing your church locations and organizing your congregation."}),e.jsx(f,{variant:"primary",size:"md",onClick:g,children:"Create Your First Branch"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(s=>e.jsxs(v,{variant:"default",className:"hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-secondary-900 dark:text-secondary-50 mb-2",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:s.description})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-secondary-200 dark:border-secondary-700",children:[s.address&&e.jsxs("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:[e.jsx("span",{className:"font-medium",children:"ðŸ“"})," ",s.address]}),s.phone&&e.jsxs("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:[e.jsx("span",{className:"font-medium",children:"ðŸ“ž"})," ",s.phone]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:s.groupCount}),e.jsx("p",{className:"text-xs text-secondary-600 dark:text-secondary-400 uppercase",children:"Groups"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-success-600 dark:text-success-400",children:s.memberCount}),e.jsx("p",{className:"text-xs text-secondary-600 dark:text-secondary-400 uppercase",children:"Members"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>B(s),fullWidth:!0,children:"Edit"}),e.jsx(f,{variant:"danger",size:"sm",onClick:()=>w(s.id),disabled:p===s.id||n.length===1,fullWidth:!0,children:p===s.id?"Deleting...":"Delete"})]})]},s.id))})]}),e.jsx(q,{isOpen:N,onClose:()=>o(!1),onSuccess:k,churchId:t.church?.id||"",branch:m})]})}export{W as BranchesPage,W as default};
//# sourceMappingURL=BranchesPage-DPRzXTlF.js.map
