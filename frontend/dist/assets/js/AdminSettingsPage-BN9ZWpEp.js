import{j as e,m as s}from"./vendor-ui-DmDBw7yB.js";import{a as t}from"./vendor-react-GajVb7Yi.js";import{I as a,_ as r}from"./index-BPwADyyg.js";import{b as n,i,r as l,c as o,l as d,d as c,g as m,a as x,u}from"./focus-trap-react-T-2iBaXT.js";import{S as h,a as p}from"./SoftLayout-DSbEAR6L.js";import{S as g}from"./SoftButton-BT31kdh0.js";import{L as f,C as b,n as j,B as y,E as N,J as v,e as w,m as C,t as S,i as k,f as P,p as A,y as I,X as R}from"./vendor-utils-DyFjxm_c.js";import T from"./PhoneNumberPurchaseModal-Cdm37eXD.js";import{g as E,r as L}from"./rcs-DKvzY8mR.js";import{u as M}from"./useBreakpoint-D_gF-sG6.js";import{d as D}from"./designTokens-BhFJIg83.js";import"./react-stripe.esm-Bb9JIkK3.js";import"./vendor-charts-D9m5HzY1.js";function F({tabs:s,value:t,onChange:a,variant:r="auto",className:n=""}){const{isMobile:i,isTablet:l}=M();let o=r;return"auto"===r&&(o=i?"dropdown":"scroll"),s.find(e=>e.value===t),"dropdown"===o?e.jsx("div",{className:n,children:e.jsx("select",{value:t,onChange:e=>a(e.target.value),style:{width:"100%",padding:`${D.spacing.md} ${D.spacing.lg}`,backgroundColor:D.colors.input,border:`${D.borderWidth.base} solid ${D.colors.border}`,borderRadius:D.borderRadius.md,fontSize:D.typography.fontSize.base,fontWeight:D.typography.fontWeight.medium,color:D.colors.foreground,cursor:"pointer",minHeight:D.touchTarget.enhanced,appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='${encodeURIComponent(D.colors.foreground)}' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center",paddingRight:`${D.spacing.xl}`},children:s.map(s=>e.jsx("option",{value:s.value,disabled:s.disabled,children:s.label},s.value))})}):e.jsx("div",{className:n,style:{display:"flex",gap:D.spacing.md,overflowX:"scroll"===o?"auto":"visible",overflowY:"hidden",paddingBottom:D.spacing.sm,scrollBehavior:"smooth",WebkitOverflowScrolling:"touch"},children:s.map(s=>e.jsxs("button",{onClick:()=>!s.disabled&&a(s.value),disabled:s.disabled,style:{display:"flex",alignItems:"center",gap:D.spacing.sm,padding:`${D.spacing.md} ${D.spacing.lg}`,backgroundColor:t===s.value?D.colors.primary:D.colors["background-secondary"],color:t===s.value?D.colors.background:D.colors.foreground,border:`${D.borderWidth.base} solid ${t===s.value?D.colors.primary:D.colors.border}`,borderRadius:D.borderRadius.md,fontSize:D.typography.fontSize.sm,fontWeight:D.typography.fontWeight.medium,cursor:s.disabled?"not-allowed":"pointer",minHeight:D.touchTarget.enhanced,minWidth:"max-content",whiteSpace:"nowrap",opacity:s.disabled?.5:1,transition:`all ${D.transition.fast} ease`,boxShadow:t===s.value?D.shadow.sm:D.shadow.none},"aria-selected":t===s.value,role:"tab",children:[s.icon&&e.jsx("span",{children:s.icon}),s.label]},s.value))})}function O(){const[n,i]=t.useState(!0),[l,o]=t.useState(!1),[d,c]=t.useState(null),[m,x]=t.useState("");t.useEffect(()=>{u()},[]);const u=async()=>{try{i(!0);const e=await E();c(e),e.agentId&&x(e.agentId)}catch(e){}finally{i(!1)}};return n?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(s.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(f,{className:"w-8 h-8 text-primary"})})}):e.jsxs("div",{className:"max-w-2xl space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-6",children:"RCS Business Messaging"}),e.jsx(h,{variant:"gradient",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl "+(d?.ready?"bg-green-500/20":"bg-yellow-500/20"),children:d?.ready?e.jsx(b,{className:"w-6 h-6 text-green-500"}):e.jsx(j,{className:"w-6 h-6 text-yellow-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-1",children:d?.ready?"RCS Enabled":"RCS Not Configured"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:d?.message||"Configure RCS to send rich cards, carousels, and interactive buttons"}),d?.agentId&&e.jsxs("p",{className:"text-sm text-foreground/80 mt-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Agent ID:"})," ",e.jsx("code",{className:"bg-muted px-2 py-0.5 rounded",children:d.agentId})]})]})]})}),e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx(y,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground mb-2",children:"What is RCS Business Messaging?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"RCS (Rich Communication Services) enables iMessage-like features for Android and iPhone users:"})]})]}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground ml-8",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),"Rich cards with images, titles, and action buttons"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),"Swipeable carousels for events and schedules"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),"Quick reply buttons (Yes/No/Maybe)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),"Read receipts and typing indicators"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),"HD images and videos (no compression)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),"Automatic SMS fallback for non-RCS devices"]})]})]}),e.jsxs(h,{children:[e.jsxs("h4",{className:"font-medium text-foreground mb-4 flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"RCS Agent Configuration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(a,{label:"Telnyx RCS Agent ID",value:m,onChange:e=>x(e.target.value),placeholder:"Enter your RCS Agent ID from Telnyx"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"You can find this in your Telnyx Mission Control portal under RCS > Agents"})]}),e.jsx(g,{variant:"primary",onClick:async()=>{if(m.trim())try{o(!0),await L(m.trim()),r.success("RCS Agent registered successfully!"),u()}catch(e){r.error(e.message||"Failed to register RCS Agent")}finally{o(!1)}else r.error("Please enter your RCS Agent ID")},disabled:l||!m.trim(),icon:l?e.jsx(s.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(f,{className:"w-4 h-4"})}):e.jsx(j,{className:"w-4 h-4"}),children:l?"Saving...":d?.configured?"Update RCS Agent":"Enable RCS"})]})]}),e.jsxs(h,{variant:"default",children:[e.jsx("h4",{className:"font-medium text-foreground mb-4",children:"How to Get an RCS Agent ID"}),e.jsxs("ol",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/20 text-primary text-xs flex items-center justify-center font-bold",children:"1"}),e.jsxs("span",{children:["Log in to"," ",e.jsxs("a",{href:"https://portal.telnyx.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline inline-flex items-center gap-1",children:["Telnyx Mission Control ",e.jsx(v,{className:"w-3 h-3"})]})]})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/20 text-primary text-xs flex items-center justify-center font-bold",children:"2"}),e.jsx("span",{children:"Navigate to Messaging > RCS > Agents"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/20 text-primary text-xs flex items-center justify-center font-bold",children:"3"}),e.jsx("span",{children:"Create a new RCS Agent with your church's branding (logo, name, description)"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/20 text-primary text-xs flex items-center justify-center font-bold",children:"4"}),e.jsx("span",{children:"Submit your agent for verification (typically takes 1-3 business days)"})]}),e.jsxs("li",{className:"flex gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/20 text-primary text-xs flex items-center justify-center font-bold",children:"5"}),e.jsx("span",{children:"Copy the Agent ID and paste it above"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 rounded-lg border border-yellow-500/20",children:e.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:[e.jsx("strong",{children:"Note:"})," RCS agent verification requires business verification. Have your church's EIN, address, and website ready."]})})]})]})}function W(){const[s,a]=t.useState([]),[o,d]=t.useState(!0),[c,m]=t.useState(null),[x,u]=t.useState(!1),[p,b]=t.useState(!1),[j,y]=t.useState(null),[N,v]=t.useState({email:"",firstName:"",lastName:""});t.useEffect(()=>{S()},[]);const S=async()=>{try{d(!0);const e=await n();a(e)}catch(e){r.error(e.message||"Failed to load co-admins")}finally{d(!1)}};return o?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(f,{className:"w-6 h-6 text-primary animate-spin"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Co-Admin Management"}),e.jsx(g,{variant:"primary",onClick:()=>u(!x),icon:e.jsx(w,{className:"w-4 h-4"}),children:x?"Cancel":"Invite Co-Admin"})]}),x&&e.jsxs(h,{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Invite New Co-Admin"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),N.email&&N.firstName&&N.lastName)try{b(!0);const e=await i({email:N.email,firstName:N.firstName,lastName:N.lastName});y(e.data),v({email:"",firstName:"",lastName:""}),r.success("Co-admin invited successfully"),S()}catch(s){r.error(s.message||"Failed to invite co-admin")}finally{b(!1)}else r.error("Please fill in all fields")},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"First Name"}),e.jsx("input",{type:"text",value:N.firstName,onChange:e=>v({...N,firstName:e.target.value}),className:"w-full px-4 py-2 border border-border/40 rounded-lg bg-card/50 text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors duration-normal backdrop-blur-sm",placeholder:"John",disabled:p})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"Last Name"}),e.jsx("input",{type:"text",value:N.lastName,onChange:e=>v({...N,lastName:e.target.value}),className:"w-full px-4 py-2 border border-border/40 rounded-lg bg-card/50 text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors duration-normal backdrop-blur-sm",placeholder:"Doe",disabled:p})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-1",children:"Email"}),e.jsx("input",{type:"email",value:N.email,onChange:e=>v({...N,email:e.target.value}),className:"w-full px-4 py-2 border border-border/40 rounded-lg bg-card/50 text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors duration-normal backdrop-blur-sm",placeholder:"john.doe@example.com",disabled:p})]}),e.jsx(g,{type:"submit",variant:"primary",fullWidth:!0,disabled:p,children:p?"Inviting...":"Send Invite"})]})]}),j&&e.jsxs(h,{variant:"gradient",className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Co-Admin Invited Successfully!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Share the following credentials with ",e.jsx("strong",{children:j.admin.email}),":"]}),e.jsxs(h,{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-foreground mb-2",children:[e.jsx("strong",{children:"Email:"})," ",j.admin.email]}),e.jsxs("p",{className:"text-sm text-foreground mb-2",children:[e.jsx("strong",{children:"Temporary Password:"}),e.jsx("code",{className:"ml-2 bg-muted/50 px-2 py-1 rounded font-mono text-primary",children:j.tempPassword}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(j.tempPassword),r.success("Password copied to clipboard")},className:"ml-2 text-primary hover:text-primary/80 text-sm font-medium",children:"Copy"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"They can log in with this temporary password and change it after first login."}),e.jsx(g,{variant:"primary",onClick:()=>y(null),children:"Done"})]}),0===s.length?e.jsxs(h,{className:"text-center py-12 mb-6",children:[e.jsx("p",{className:"text-muted-foreground",children:"No co-admins yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:'Click "Invite Co-Admin" to add your first co-admin'})]}):e.jsx(h,{className:"mb-6 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"border-b border-border/40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Added"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Last Login"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border/40",children:s.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-foreground",children:[s.firstName," ",s.lastName]}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:s.email}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:s.lastLoginAt?new Date(s.lastLoginAt).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsxs("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to remove this co-admin? They will lose access immediately."))try{m(e),await l(e),r.success("Co-admin removed successfully"),S()}catch(s){r.error(s.message||"Failed to remove co-admin")}finally{m(null)}})(s.id),disabled:c===s.id,className:"inline-flex items-center gap-1 text-danger hover:text-danger/80 disabled:opacity-50 font-medium",children:[e.jsx(C,{className:"w-4 h-4"}),c===s.id?"Removing...":"Remove"]})})]},s.id))})]})})}),e.jsx(h,{variant:"gradient",children:e.jsxs("p",{className:"text-sm text-foreground",children:["â„¹ï¸ ",e.jsx("strong",{children:"Tip:"})," Co-admins can manage branches, groups, members, and messages. They cannot manage billing or other co-admins."]})})]})}function $(){const[s,a]=t.useState(null),[n,i]=t.useState(!0),[l,d]=t.useState(1);t.useEffect(()=>{c()},[l]);const c=async()=>{try{i(!0);const e=await o(l,50);a(e)}catch(e){r.error(e.message||"Failed to load activity logs")}finally{i(!1)}};return n?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(f,{className:"w-6 h-6 text-primary animate-spin"})}):s&&0!==s.logs.length?e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground mb-6",children:"Activity Logs"}),e.jsx(h,{className:"mb-6 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"border-b border-border/40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Action"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Admin"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-foreground",children:"Timestamp"})]})}),e.jsx("tbody",{className:"divide-y divide-border/40",children:s.logs.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-foreground",children:s.action}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:s.details}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:s.adminEmail}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:new Date(s.timestamp).toLocaleString()})]},s.id))})]})})}),s.pagination.pages>1&&e.jsx(h,{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(l-1)*s.pagination.limit+1," to"," ",Math.min(l*s.pagination.limit,s.pagination.total)," of"," ",s.pagination.total," logs"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"secondary",size:"sm",onClick:()=>d(Math.max(1,l-1)),disabled:1===l,icon:e.jsx(S,{className:"w-4 h-4"}),children:"Previous"}),e.jsxs("div",{className:"px-4 py-2 text-sm text-muted-foreground font-medium",children:["Page ",l," of ",s.pagination.pages]}),e.jsx(g,{variant:"secondary",size:"sm",onClick:()=>d(Math.min(s.pagination.pages,l+1)),disabled:l===s.pagination.pages,icon:e.jsx(k,{className:"w-4 h-4"}),children:"Next"})]})]})}),e.jsx(h,{variant:"gradient",children:e.jsxs("p",{className:"text-sm text-foreground",children:["â„¹ï¸ ",e.jsx("strong",{children:"Activity logs:"})," All user actions are logged for security and compliance purposes. Logs are retained for 90 days."]})})]}):e.jsx(h,{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No activity logs yet"})})}function B({currentPhoneNumber:s,onSuccess:n}){const[i,l]=t.useState(s||""),[o,m]=t.useState(!1),[x,u]=t.useState(!s),[h,p]=t.useState(s),[b,j]=t.useState(null);t.useEffect(()=>{p(s),u(!s)},[s]);const[y,N]=t.useState(!1),[v,w]=t.useState(""),[S,k]=t.useState(!1),[T,E]=t.useState(!1);return e.jsxs("div",{className:"space-y-4",children:[h&&!x&&e.jsx("div",{className:"p-4 bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Phone Number Linked"}),e.jsx("p",{className:"text-lg font-bold text-green-500 mt-1",children:h}),"auto"===b&&e.jsx("p",{className:"text-xs text-green-600 mt-2",children:"âœ… Webhook auto-created successfully"}),"manual"===b&&e.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"âš ï¸ Please configure webhook manually in Telnyx dashboard"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx(g,{variant:"secondary",size:"sm",onClick:()=>u(!0),children:"Change"}),e.jsx(g,{variant:"danger",size:"sm",onClick:()=>N(!0),children:e.jsx(C,{className:"w-4 h-4"})})]})]})}),x&&e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i.trim())try{m(!0);const e=await d(i);e.success&&(p(e.data.phoneNumber),j(e.data.webhookId?"auto":"manual"),u(!1),l(""),r.success(e.data.message),n?.(e.data.phoneNumber,e.data.webhookId))}catch(s){const e=s.message;r.error(e||"Failed to link phone number"),j(null)}finally{m(!1)}else r.error("Please enter a phone number")},className:"space-y-4 p-4 bg-muted/50 rounded-lg border border-border/40",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Telnyx Phone Number"}),e.jsx(a,{type:"tel",placeholder:"+1 (555) 123-4567",value:i,onChange:e=>l(e.target.value),disabled:o,autoFocus:!0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Enter the phone number you purchased from Telnyx (in any format)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"primary",type:"submit",disabled:o||!i.trim(),className:"flex-1",children:o?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 animate-spin mr-2 inline"}),"Linking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-4 h-4 mr-2 inline"}),"Link Phone Number"]})}),h&&e.jsx(g,{variant:"secondary",type:"button",onClick:()=>{u(!1),l("")},disabled:o,children:"Cancel"})]}),e.jsxs("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg flex gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-blue-600",children:"When you link a phone number, we'll automatically create a webhook in your Telnyx account. Members can then start texting this number to send messages and media!"})]})]}),!x&&h&&e.jsx("div",{className:"p-3 bg-primary/10 border border-primary/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-primary/80",children:[e.jsx("strong",{children:"What happens next?"})," Your congregation can now text ",e.jsx("strong",{children:h})," to start conversations with you. Messages and media will appear in your Conversations dashboard!"]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-background rounded-lg border border-border max-w-md w-full p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Delete Phone Number"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"This action has a 30-day recovery window"})]}),e.jsx("button",{onClick:()=>{N(!1),w(""),k(!1)},className:"text-muted-foreground hover:text-foreground",children:e.jsx(R,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg flex gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-red-600",children:[e.jsx("p",{className:"font-semibold mb-1",children:"âš ï¸ Important"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"All SMS conversations on this number will end"}),e.jsx("li",{children:"This number will be released from Telnyx"}),e.jsx("li",{children:"You have 30 days to contact support for recovery"}),e.jsx("li",{children:"After 30 days, this cannot be undone"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Type the phone number to confirm:"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:h}),e.jsx(a,{type:"text",placeholder:h||"Phone number",value:v,onChange:e=>w(e.target.value),disabled:T,className:"font-mono"})]}),e.jsxs("label",{className:"flex items-start gap-2",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:e=>k(e.target.checked),disabled:T,className:"mt-1 rounded"}),e.jsx("span",{className:"text-sm text-foreground",children:"I understand this cannot be undone and I want to delete this phone number"})]}),e.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-600",children:[e.jsx("strong",{children:"ðŸ“ž Need to recover?"})," Contact support within 30 days to restore this number."]})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(g,{variant:"primary",className:"flex-1",disabled:T||!S||v!==h,onClick:async()=>{if(S)if(v===h)try{E(!0);(await c({confirm:!0,confirmPhone:v})).success&&(p(null),N(!1),w(""),k(!1),r.success("Phone number deleted (30-day recovery window)"),n?.(null,null))}catch(e){const s=e.response?.data?.message||e.message||"Failed to delete phone number";r.error(s)}finally{E(!1)}else r.error(`Please type the phone number exactly: ${h}`);else r.error("Please confirm you understand the consequences")},children:T?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 animate-spin mr-2 inline"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 inline"}),"Delete Number"]})}),e.jsx(g,{variant:"secondary",className:"flex-1",disabled:T,onClick:()=>{N(!1),w(""),k(!1)},children:"Cancel"})]})]})})]})}function z(){const[n,i]=t.useState("profile"),[l,o]=t.useState(!1),[d,c]=t.useState(!1),[b,j]=t.useState(null),[y,N]=t.useState(null),[v,w]=t.useState(!1),[C,S]=t.useState(!1),[k,P]=t.useState(!1),[I,R]=t.useState({name:"",email:"",wantsPremiumDelivery:!0,ein:"",brandPhoneNumber:"",streetAddress:"",city:"",state:"",postalCode:"",website:"",entityType:"NON_PROFIT",vertical:"NGO"}),E=async()=>{try{o(!0);const e=await m();j(e),R({name:e.name||"",email:e.email||"",wantsPremiumDelivery:!0,ein:e.ein||"",brandPhoneNumber:e.brandPhoneNumber||"",streetAddress:e.streetAddress||"",city:e.city||"",state:e.state||"",postalCode:e.postalCode||"",website:e.website||"",entityType:e.entityType||"NON_PROFIT",vertical:e.vertical||"NGO"})}catch(e){r.error("Failed to load profile. Please refresh the page.")}finally{o(!1)}};t.useEffect(()=>{E(),(async()=>{try{S(!0);const e=await x();N(e.telnyxPhoneNumber)}catch(e){N(null)}finally{S(!1)}})()},[]);return e.jsxs(e.Fragment,{children:[e.jsx(p,{children:e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Settings"})}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your church account and permissions"})]}),e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"mb-8",children:e.jsxs(h,{children:[e.jsx(F,{tabs:[{label:"Church Profile",value:"profile"},{label:"Co-Admins",value:"coadmins"},{label:"Phone Numbers",value:"numbers"},{label:"RCS Messaging",value:"rcs"},{label:"Activity Logs",value:"logs"}],value:n,onChange:e=>i(e),variant:"auto",className:"p-0"}),e.jsxs("div",{className:"p-8",children:["profile"===n&&e.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-6",children:"Church Profile"}),l?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(s.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(f,{className:"w-8 h-8 text-primary"})})}):e.jsxs("form",{onSubmit:async e=>{var s;if(e.preventDefault(),I.name.trim())if(I.email.trim())if(s=I.email.trim(),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))if(I.ein.trim())if(/^\d+$/.test(I.ein.trim()))if(I.brandPhoneNumber.trim())if(/^\+1\d{10}$/.test(I.brandPhoneNumber.trim()))if(I.streetAddress.trim())if(I.city.trim())if(I.state.trim()&&2===I.state.length)if(I.postalCode.trim())if(/^\d{5}(-\d{4})?$/.test(I.postalCode.trim()))try{c(!0),await u({name:I.name.trim(),email:I.email.trim(),wantsPremiumDelivery:I.wantsPremiumDelivery,ein:I.ein.trim()||void 0,brandPhoneNumber:I.brandPhoneNumber.trim()||void 0,streetAddress:I.streetAddress.trim()||void 0,city:I.city.trim()||void 0,state:I.state.trim().toUpperCase()||void 0,postalCode:I.postalCode.trim()||void 0,website:I.website.trim()||void 0,entityType:I.entityType,vertical:I.vertical}),r.success("Profile updated successfully"),E()}catch(t){r.error("Failed to update profile. Please try again.")}finally{c(!1)}else r.error("Postal code must be 5 digits or 5+4 format");else r.error("Postal code is required");else r.error("State must be 2-letter code (e.g., CA, NY)");else r.error("City is required");else r.error("Street address is required");else r.error("Phone must be in format: +1XXXXXXXXXX");else r.error("Brand contact phone number is required");else r.error("EIN must contain only digits");else r.error("EIN (Employer Identification Number) is required");else r.error("Please enter a valid email address");else r.error("Email address is required");else r.error("Church name is required")},className:"max-w-2xl",children:[e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6",children:e.jsx(a,{label:"Church Name",type:"text",value:I.name,onChange:e=>R({...I,name:e.target.value}),placeholder:"Your church name"})}),e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"mb-6",children:e.jsx(a,{label:"Email Address",type:"email",value:I.email,onChange:e=>R({...I,email:e.target.value}),placeholder:"contact@church.com"})}),e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-8",children:e.jsxs(h,{variant:"gradient",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"10DLC Brand Information"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Required for SMS messaging approval. Fill in your church's legal information."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"EIN (Employer Identification Number) *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:I.ein?k?I.ein.length>=2?`${I.ein.slice(0,2)}-${I.ein.slice(2)}`:I.ein:I.ein.length>=2?`â€¢â€¢-${I.ein.slice(2).replace(/./g,"â€¢")}`:I.ein.replace(/./g,"â€¢"):"",onChange:e=>{const s=e.target.value.replace(/\D/g,"").slice(0,9);R({...I,ein:s})},placeholder:k?"12-3456789":"â€¢â€¢-â€¢â€¢â€¢â€¢â€¢â€¢â€¢",maxLength:10,required:!0,className:"w-full pl-10 pr-20 py-2.5 border border-border/40 rounded-lg bg-card/50 text-foreground font-mono text-base tracking-wider focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-normal backdrop-blur-sm",style:{letterSpacing:"0.1em"}}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("button",{type:"button",onClick:()=>P(!k),className:"absolute right-2 top-1/2 -translate-y-1/2 px-3 py-1.5 rounded-md text-xs font-medium transition-all duration-200 hover:bg-primary/10 focus:outline-none focus:ring-2 focus:ring-primary/50 flex items-center gap-1.5 text-foreground/70 hover:text-foreground","aria-label":k?"Hide EIN":"Show EIN",children:k?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),e.jsx("span",{children:"Hide"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),e.jsx("span",{children:"Show"})]})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1.5 flex items-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("span",{children:"9-digit federal tax ID â€¢ AES-256 encrypted â€¢ Securely stored"})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx(a,{label:"Brand Contact Phone",type:"tel",value:I.brandPhoneNumber,onChange:e=>R({...I,brandPhoneNumber:e.target.value}),placeholder:"+12025551234",required:!0})}),e.jsx("div",{className:"mb-6",children:e.jsx(a,{label:"Street Address",type:"text",value:I.streetAddress,onChange:e=>R({...I,streetAddress:e.target.value}),placeholder:"123 Main Street",required:!0})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsx(a,{label:"City",type:"text",value:I.city,onChange:e=>R({...I,city:e.target.value}),placeholder:"New York",required:!0}),e.jsx(a,{label:"State (2-letter)",type:"text",value:I.state,onChange:e=>R({...I,state:e.target.value.toUpperCase().slice(0,2)}),placeholder:"NY",maxLength:2,required:!0})]}),e.jsx("div",{className:"mb-6",children:e.jsx(a,{label:"Postal Code",type:"text",value:I.postalCode,onChange:e=>R({...I,postalCode:e.target.value}),placeholder:"10001",required:!0})}),e.jsx("div",{className:"mb-6",children:e.jsx(a,{label:"Church Website (Optional)",type:"url",value:I.website,onChange:e=>R({...I,website:e.target.value}),placeholder:"https://yourchurch.com"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Entity Type"}),e.jsxs("select",{value:I.entityType,onChange:e=>R({...I,entityType:e.target.value}),className:"w-full px-3 py-2 bg-muted border border-border rounded-md text-foreground",children:[e.jsx("option",{value:"NON_PROFIT",children:"Non-Profit (Recommended for churches)"}),e.jsx("option",{value:"PRIVATE_CORPORATION",children:"Private Corporation"}),e.jsx("option",{value:"PUBLIC_CORPORATION",children:"Public Corporation"}),e.jsx("option",{value:"GOVERNMENT_ENTITY",children:"Government Entity"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Industry Vertical"}),e.jsxs("select",{value:I.vertical,onChange:e=>R({...I,vertical:e.target.value}),className:"w-full px-3 py-2 bg-muted border border-border rounded-md text-foreground",children:[e.jsx("option",{value:"NGO",children:"Non-Governmental Organization (NGO) - For churches"}),e.jsx("option",{value:"EDUCATION",children:"Education"}),e.jsx("option",{value:"HEALTHCARE",children:"Healthcare"}),e.jsx("option",{value:"FINANCE",children:"Finance"})]})]})]})]})}),b&&e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-6",children:e.jsxs(h,{variant:"gradient",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-3",children:"Account Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"})," ",e.jsx("span",{className:"font-medium text-foreground",children:b.subscriptionStatus})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"})," ",e.jsx("span",{className:"font-medium text-foreground",children:new Date(b.createdAt).toLocaleDateString()})]})]})]})}),e.jsx(g,{type:"submit",variant:"primary",disabled:d,children:d?"Saving...":"Save Changes"})]})]}),"coadmins"===n&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx(W,{})}),"numbers"===n&&e.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-6",children:"Phone Numbers"}),C?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(s.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(f,{className:"w-8 h-8 text-primary"})})}):e.jsxs("div",{className:"max-w-2xl space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(B,{currentPhoneNumber:y,onSuccess:(e,s)=>{N(e),e?r.success("Phone number linked successfully!"):r.success("Phone number deleted (30-day recovery window)")}})}),e.jsxs(h,{variant:"gradient",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(A,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-semibold text-foreground",children:"Current Phone Number"})]}),y?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:y}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your active Telnyx phone number for receiving SMS messages and conversations."})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-muted-foreground",children:"No phone number linked yet. Link a number you've purchased from Telnyx above or buy one to start."}),e.jsx(g,{variant:"primary",onClick:()=>w(!0),children:"Buy Phone Number"})]})]}),e.jsxs(h,{variant:"default",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-3",children:"About Phone Numbers"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-primary font-bold",children:"â€¢"}),e.jsx("span",{children:"Each church gets one dedicated phone number for receiving member conversations"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-primary font-bold",children:"â€¢"}),e.jsx("span",{children:"Members text your number to start conversations with your church"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-primary font-bold",children:"â€¢"}),e.jsx("span",{children:"When you link a number, we automatically create a webhook for receiving messages"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-primary font-bold",children:"â€¢"}),e.jsx("span",{children:"Numbers are powered by Telnyx for reliable SMS/MMS delivery"})]})]})]})]})]}),"rcs"===n&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx(O,{})}),"logs"===n&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx($,{})})]})]})})]})}),e.jsx(T,{isOpen:v,onClose:()=>w(!1),onPurchaseComplete:e=>{N(e),w(!1),r.success("Phone number purchased successfully!")}})]})}export{z as AdminSettingsPage,z as default};
