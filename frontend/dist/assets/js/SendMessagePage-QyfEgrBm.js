import{j as e,m as s}from"./vendor-ui-DmDBw7yB.js";import{a}from"./vendor-react-GajVb7Yi.js";import{_ as t}from"./index-DhvhFPHl.js";import{u as i,s as r}from"./messages-BP6IlIG5.js";import{g as n,T as l}from"./TemplateFormModal-D0ikTDam.js";import{a as o,S as c}from"./SoftLayout-CsGqlU8c.js";import{S as d}from"./SoftButton-BT31kdh0.js";import{F as m,j as x,L as p}from"./vendor-utils-DZXJUmYg.js";import"./index.esm-BdG2FjqQ.js";function h(){const{addMessage:h}=i(),[u,f]=a.useState(""),[j,g]=a.useState(!1),[y,b]=a.useState(!1),[v,N]=a.useState([]),[w,S]=a.useState(!1);a.useEffect(()=>{C()},[]);const C=async()=>{b(!0);try{const e=await n().catch(e=>[]);N(e)}catch(e){t.error("Failed to load page data")}finally{b(!1)}},M=Math.ceil(u.length/160)||0;return e.jsxs(o,{children:[e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full max-w-4xl mx-auto",children:[e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Send Message"})}),e.jsx("p",{className:"text-muted-foreground",children:"Reach your congregation with direct SMS messages"})]})}),e.jsxs(c,{className:"space-y-6",children:[v.length>0&&e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsxs("label",{className:"block text-sm font-semibold text-foreground mb-3 flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4"}),"Use Template"]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[v.slice(0,6).map(s=>e.jsx(d,{variant:"secondary",size:"sm",onClick:()=>(e=>{f(e.content),t.success(`Using template: ${e.name}`)})(s),children:s.name},s.id)),v.length>6&&e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>window.location.href="/templates",children:"More Templates..."})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},children:[e.jsxs("label",{className:"block text-sm font-semibold text-foreground mb-3 flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),"Message Content"]}),e.jsx("textarea",{value:u,onChange:e=>f(e.target.value.slice(0,1600)),className:"w-full px-4 py-3 border border-border/40 rounded-lg bg-card/50 text-foreground placeholder-muted-foreground/50 focus:outline-none focus:ring-2 focus:ring-primary resize-none transition-colors duration-normal backdrop-blur-sm",rows:6,placeholder:"Type your message here...",maxLength:1600}),e.jsxs("div",{className:"flex justify-between mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{children:[u.length," / 1600 characters"]}),e.jsxs("span",{children:[M," SMS segment",1!==M?"s":"",M>0&&` ($${(.0075*M).toFixed(4)} per recipient)`]})]}),u.trim()&&e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>S(!0),className:"mt-2",children:"Save as Template"})]}),e.jsx(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(c,{variant:"gradient",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:"ğŸ“¬ Message will be sent to:"}),e.jsx("p",{className:"text-sm text-foreground/80",children:"All members in your church"})]})})}),M>0&&e.jsx(s.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.25},children:e.jsx(c,{variant:"gradient",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-foreground/80",children:"Cost per recipient:"}),e.jsxs("span",{className:"font-medium text-foreground",children:["$",(.0075*M).toFixed(4)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-foreground/80",children:"Segments:"}),e.jsx("span",{className:"font-medium text-foreground",children:M})]}),e.jsx("div",{className:"border-t border-border/40 pt-2",children:e.jsx("p",{className:"text-xs text-foreground/60",children:"Total cost will depend on the number of members who receive this message"})})]})})}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"flex gap-3 pt-4",children:[e.jsx(d,{variant:"secondary",size:"md",onClick:()=>{f("")},disabled:j,children:"Clear"}),e.jsx(d,{variant:"primary",size:"md",fullWidth:!0,onClick:async()=>{if(u.trim())try{g(!0);const e=await r({content:u.trim(),targetType:"all"});h(e),t.success(`Message queued for ${e.totalRecipients} recipients`),f("")}catch(e){t.error(e.message||"Failed to send message")}finally{g(!1)}else t.error("Please enter a message")},disabled:j||!u.trim(),icon:j?e.jsx(s.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(p,{className:"w-4 h-4"})}):e.jsx(x,{className:"w-4 h-4"}),children:j?"Sending...":"Send Message"})]})]})]}),w&&e.jsx(l,{template:null,onClose:()=>{S(!1),C()}})]})}export{h as SendMessagePage,h as default};
