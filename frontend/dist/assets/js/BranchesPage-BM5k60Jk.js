import{j as e,m as r}from"./vendor-ui-DhbhiCKM.js";import{a as s}from"./vendor-react-DC7Nk3dg.js";import{_ as a,d as t,e as n,u as d,a as i,g as l,h as c}from"./index-BBK03AmT.js";import{u as o}from"./index.esm-C8Q_B5eL.js";import{a as m,S as x}from"./SoftLayout-DrlEjH-k.js";import{S as u}from"./SoftButton-CoQCJuB5.js";import{L as h,m as b,P as p,n as g}from"./vendor-utils-C8GUPZyx.js";function f({isOpen:r,onClose:d,onSuccess:i,churchId:l,branch:c}){const[m,x]=s.useState(!1),{register:u,handleSubmit:h,reset:b,formState:{errors:p}}=o({defaultValues:{name:c?.name||"",address:c?.address||"",phone:c?.phone||"",description:c?.description||""}});if(!r)return null;return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:c?"Edit Branch":"Create New Branch"}),e.jsxs("form",{onSubmit:h(async e=>{if(e.name&&e.name.trim()){x(!0);try{let r;c?(r=await t(c.id,e),a.success("Branch updated successfully")):(r=await n(l,e),a.success("Branch created successfully")),b(),i(r),d()}catch(r){const e=r.response?.data?.error||"Failed to save branch";a.error(e)}finally{x(!1)}}else a.error("Branch name is required")}),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Branch Name *"}),e.jsx("input",{type:"text",...u("name",{required:"Branch name is required"}),placeholder:"e.g., Main Location, Downtown Campus",className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:m}),p.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Address"}),e.jsx("input",{type:"text",...u("address"),placeholder:"123 Main St, City, State",className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:m})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...u("phone"),placeholder:"(555) 123-4567",className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:m})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{...u("description"),placeholder:"Additional details about this branch...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",disabled:m})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{b(),d()},disabled:m,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 disabled:bg-gray-100 dark:disabled:bg-slate-700 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition",children:m?"Saving...":c?"Update":"Create"})]})]})]})})})}function j(){const t=d(),{branches:n,setBranches:o,addBranch:j,updateBranch:y,removeBranch:N,isLoading:v,setLoading:w}=i(),[k,B]=s.useState(!1),[C,S]=s.useState(void 0),[D,F]=s.useState(null);s.useEffect(()=>{t.church?.id&&L()},[t.church?.id]);const L=async()=>{if(t.church?.id){w(!0);try{const e=await l(t.church.id);o(e)}catch(e){a.error("Failed to load branches")}finally{w(!1)}}},M=()=>{S(void 0),B(!0)};return v&&0===n.length?e.jsx(m,{children:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(r.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(h,{className:"w-8 h-8 text-primary"})})})}):e.jsxs(m,{children:[e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex items-center justify-between mb-8 flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Branches"})}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your church locations"})]}),e.jsx(u,{variant:"primary",size:"lg",onClick:M,children:"New Branch"})]}),0===n.length?e.jsxs(x,{className:"text-center py-16",children:[e.jsx("div",{className:"mb-6",children:e.jsx(b,{className:"w-16 h-16 text-muted-foreground/50 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"No Branches Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Create your first branch to start managing your church locations and organizing your congregation."}),e.jsx(u,{variant:"primary",onClick:M,children:"Create Your First Branch"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map((s,t)=>e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},children:e.jsxs(x,{variant:"default",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-2",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"space-y-2 mb-6 pb-6 border-b border-border/40",children:[s.address&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(b,{className:"w-4 h-4 inline mr-2"}),s.address]}),s.phone&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ“ž ",s.phone]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.groupCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Groups"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.memberCount}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase",children:"Members"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(u,{variant:"secondary",onClick:()=>(e=>{S(e),B(!0)})(s),fullWidth:!0,children:[e.jsx(p,{className:"w-4 h-4"}),"Edit"]}),e.jsxs(u,{variant:"danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this branch? This action cannot be undone.")){F(e);try{const r=await c(e);N(e),a.success(`Branch deleted. ${r.groupsDeleted} group(s) and ${r.membersDeleted} member(s) were removed.`)}catch(r){const e=r.response?.data?.error||"Failed to delete branch";a.error(e)}finally{F(null)}}})(s.id),disabled:D===s.id||1===n.length,fullWidth:!0,children:[e.jsx(g,{className:"w-4 h-4"}),D===s.id?"Deleting...":"Delete"]})]})]})},s.id))})]}),e.jsx(f,{isOpen:k,onClose:()=>B(!1),onSuccess:e=>{C?y(e.id,e):j(e)},churchId:t.church?.id||"",branch:C})]})}export{j as BranchesPage,j as default};
