import{j as e,m as t,A as a}from"./vendor-ui-DhbhiCKM.js";import{a as r,u as s}from"./vendor-react-DC7Nk3dg.js";import{B as i,c as l,_ as n,u as o,a as d}from"./index-BUqT_DpG.js";import{g as c,a as m}from"./analytics-Cch2C2BM.js";import{g as x}from"./members-D_Kxh9N7.js";import{g}from"./groups-DGIBzbr_.js";import{F as u,g as p,P as h,a as b}from"./PhoneNumberPurchaseModal-Dtkgyn9D.js";import{S as y,a as j}from"./SoftLayout-CdjBOXH9.js";import{g as v}from"./billing-ZfBHReh1.js";import{C as f}from"./ChatWidget-awkEoLEy.js";import{X as N,f as w,C as k,h as C,i as S,Z as L,A as D,L as M,j as T,U as P,T as R,k as $}from"./vendor-utils-C8GUPZyx.js";import{R as E,B as F,C as B,X as W,Y as A,T as _,a as O,P as z,b as U,c as G,L as K,d as Y}from"./vendor-charts-B4neLzXX.js";import"./index-BO2dpB2-.js";function H({icon:a,label:r,value:s,change:i,changeType:l="neutral",gradient:n="from-blue-500 to-cyan-500",index:o=0}){const d="positive"===l?"text-green-400":"negative"===l?"text-red-400":"text-muted-foreground",c=void 0!==i&&i>0?"+":"";return e.jsxs(y,{variant:"gradient",index:o,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx(t.div,{animate:{scale:[1,1.05,1]},transition:{duration:3,repeat:1/0},className:`bg-gradient-to-br ${n} rounded-xl p-3 shadow-lg`,children:e.jsx(a,{className:"w-6 h-6 text-white"})}),void 0!==i&&e.jsxs("div",{className:`text-sm font-bold ${d}`,children:[c,i,"%"]})]}),e.jsx("p",{className:"text-muted-foreground text-sm font-medium mb-2",children:r}),e.jsx("p",{className:"text-3xl font-bold text-foreground",children:s})]})}function I({dlcStatus:t,deliveryRate:a,wantsPremiumDelivery:r,size:s="md",variant:i="badge"}){const l="shared_brand"===t?{emoji:"ðŸ“Š",text:"Standard Delivery",subtext:"65% delivery rate",bgColor:"bg-blue-50",textColor:"text-blue-900",borderColor:"border-blue-200",badgeBg:"bg-blue-100",badgeText:"text-blue-800"}:"approved"===t?{emoji:"âœ…",text:"Premium 10DLC",subtext:"99% delivery rate",bgColor:"bg-green-50",textColor:"text-green-900",borderColor:"border-green-200",badgeBg:"bg-green-100",badgeText:"text-green-800"}:"pending"===t||"brand_verified"===t||"campaign_pending"===t?{emoji:"â³",text:"Pending Approval",subtext:"Premium 10DLC (99% when approved)",bgColor:"bg-yellow-50",textColor:"text-yellow-900",borderColor:"border-yellow-200",badgeBg:"bg-yellow-100",badgeText:"text-yellow-800"}:"rejected"===t?{emoji:"âŒ",text:"Approval Failed",subtext:"Contact support",bgColor:"bg-red-50",textColor:"text-red-900",borderColor:"border-red-200",badgeBg:"bg-red-100",badgeText:"text-red-800"}:{emoji:"â“",text:"Unknown Status",subtext:t||"Loading...",bgColor:"bg-gray-50",textColor:"text-gray-900",borderColor:"border-gray-200",badgeBg:"bg-gray-100",badgeText:"text-gray-800"},n={sm:"px-2 py-1 text-xs",md:"px-3 py-2 text-sm",lg:"px-4 py-3 text-base"};return"badge"===i?e.jsxs("span",{className:`inline-flex items-center gap-1.5 ${n[s]} rounded-full ${l.badgeBg} ${l.badgeText} font-medium`,children:[e.jsx("span",{children:l.emoji}),e.jsx("span",{children:l.text})]}):"inline"===i?e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:l.emoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:l.text}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.subtext}),a&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Current rate: ",Math.round(100*a),"%"]})]})]}):e.jsx("div",{className:`rounded-lg border ${l.borderColor} ${l.bgColor} p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-3xl",children:l.emoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-semibold ${l.textColor}`,children:l.text}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l.subtext}),a&&e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full "+("approved"===t?"bg-green-500":"shared_brand"===t?"bg-blue-500":"bg-yellow-500"),style:{width:100*a+"%"}})}),e.jsxs("span",{className:`text-xs font-medium ${l.textColor}`,children:[Math.round(100*a),"%"]})]})]})]})})}function Q(){const[t,a]=r.useState(null),[s,i]=r.useState(!0);if(r.useEffect(()=>{(async()=>{try{i(!0);const e=await v();a(e)}catch(e){}finally{i(!1)}})()},[]),s||!t)return null;if(!t.onTrial)return null;const l=t.daysRemaining,n=l<=0;let o="bg-green-50 border-green-200",d="text-green-800",c="âœ“";return n?(o="bg-red-50 border-red-200",d="text-red-800",c="âš "):l<=3&&(o="bg-yellow-50 border-yellow-200",d="text-yellow-800",c="!"),e.jsx("div",{className:`${o} border rounded-lg p-4 mb-6`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`text-lg font-bold ${d}`,children:c}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${d}`,children:n?"Trial Expired":"Free Trial Active"}),e.jsx("p",{className:`text-sm ${d} mt-1`,children:n?"Your trial has expired. Please subscribe to continue using the platform.":1===l?"Your trial expires tomorrow. Subscribe now to keep your account active.":`${l} days remaining in your trial`}),!n&&e.jsx("button",{onClick:()=>window.location.href="/subscribe",className:"mt-2 text-sm font-semibold hover:underline",children:"View Plans â†’"})]})]})})}const V=()=>e.jsxs("svg",{viewBox:"0 0 240 200",className:"w-full h-32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"120",cy:"100",r:"80",fill:"var(--color-primary)",opacity:"0.08"}),e.jsx("circle",{cx:"120",cy:"100",r:"60",fill:"var(--color-primary)",opacity:"0.05"}),e.jsx("ellipse",{cx:"70",cy:"80",rx:"16",ry:"18",fill:"var(--color-primary)"}),e.jsx("path",{d:"M 60 105 Q 70 115 75 130 M 60 105 L 50 125 M 75 105 L 85 125",stroke:"var(--color-primary)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("ellipse",{cx:"120",cy:"70",rx:"18",ry:"20",fill:"var(--color-primary)"}),e.jsx("path",{d:"M 108 95 Q 120 108 126 130 M 108 95 L 95 120 M 126 95 L 140 120",stroke:"var(--color-primary)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("ellipse",{cx:"170",cy:"85",rx:"16",ry:"18",fill:"var(--color-primary)"}),e.jsx("path",{d:"M 160 110 Q 170 120 175 135 M 160 110 L 150 130 M 175 110 L 190 130",stroke:"var(--color-primary)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx(t.circle,{cx:"50",cy:"50",r:"4",fill:"var(--color-primary)",opacity:"0.6",animate:{y:[-5,5,-5],opacity:[.3,.8,.3]},transition:{duration:2,repeat:1/0}}),e.jsx(t.circle,{cx:"180",cy:"45",r:"4",fill:"var(--color-primary)",opacity:"0.6",animate:{y:[5,-5,5],opacity:[.3,.8,.3]},transition:{duration:2.5,repeat:1/0}}),e.jsx(t.circle,{cx:"120",cy:"30",r:"3",fill:"var(--color-primary)",opacity:"0.6",animate:{y:[-8,8,-8],opacity:[.2,.7,.2]},transition:{duration:3,repeat:1/0}})]});function J({isOpen:s,onClose:o,onWelcomeComplete:d}){const[c,m]=r.useState(""),[x,g]=r.useState(!1);r.useEffect(()=>{if(!s)return;const e=e=>{"Escape"===e.key&&o()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s,o]);const p={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},h={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.4,type:"tween"}}};return e.jsx(a,{children:s&&e.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4 backdrop-blur-md",children:e.jsx(u,{focusTrapOptions:{escapeDeactivates:!0,clickOutsideDeactivates:!0},children:e.jsxs(t.div,{initial:{opacity:0,scale:.92,y:30},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.92,y:30},transition:{duration:.4,ease:"easeOut"},className:"bg-background border border-border/50 rounded-2xl shadow-2xl max-w-4xl w-full overflow-hidden",role:"dialog","aria-modal":"true","aria-labelledby":"welcome-modal-title",children:[e.jsx("div",{className:"absolute top-6 right-6 z-10",children:e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:o,className:"w-11 h-11 flex items-center justify-center hover:bg-muted rounded-lg transition-colors duration-200","aria-label":"Close modal (Escape key also works)",children:e.jsx(N,{className:"w-5 h-5 text-muted-foreground"})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-0",children:[e.jsxs(t.div,{variants:p,initial:"hidden",animate:"visible",className:"bg-gradient-to-br from-primary/5 to-primary/[0.02] p-6 md:p-8 flex flex-col items-center text-center",children:[e.jsx(t.div,{variants:h,className:"mb-4",children:e.jsx(V,{})}),e.jsx(t.div,{variants:h,children:e.jsxs("h1",{id:"welcome-modal-title",className:"text-2xl md:text-3xl font-bold text-foreground mb-2 leading-tight",children:["Welcome to",e.jsx("br",{}),e.jsx("span",{className:"bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Koinonia"})]})}),e.jsx(t.p,{variants:h,className:"text-sm text-muted-foreground leading-relaxed",children:"Connect with your congregation. Send messages, manage groups, and build community."})]}),e.jsxs(t.div,{variants:p,initial:"hidden",animate:"visible",className:"p-6 md:p-8 flex flex-col",children:[e.jsxs(t.div,{variants:h,children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-1",children:"How would you describe your role?"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"We'll personalize your experience based on your position."})]}),e.jsx(t.div,{variants:p,initial:"hidden",animate:"visible",className:"space-y-2 mb-6",children:[{id:"pastor",label:"Pastor / Lead Minister",description:"Lead your congregation spiritually",icon:"â›ª"},{id:"admin",label:"Church Administrator",description:"Manage operations and logistics",icon:"ðŸ“‹"},{id:"communications",label:"Communications Lead",description:"Handle messaging and outreach",icon:"ðŸ“¢"},{id:"volunteer",label:"Volunteer Coordinator",description:"Coordinate volunteer activities",icon:"ðŸ‘¥"},{id:"other",label:"Other",description:"Something else",icon:"â­"}].map(a=>e.jsxs(t.label,{variants:h,whileHover:{scale:1.02},className:"relative flex items-start gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 group "+(c===a.id?"border-primary bg-primary/8 shadow-md":"border-border/30 hover:border-primary/40 hover:bg-muted/40 bg-muted/20"),children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all "+(c===a.id?"border-primary bg-primary":"border-border/50 group-hover:border-primary/50"),children:c===a.id&&e.jsx(t.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:e.jsx(w,{className:"w-3 h-3 text-background"})})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"text-base",children:a.icon}),e.jsx("span",{className:"font-medium text-foreground text-xs",children:a.label})]}),e.jsx("p",{className:"text-[10px] text-muted-foreground leading-tight",children:a.description})]}),e.jsx("input",{type:"radio",name:"role",value:a.id,checked:c===a.id,onChange:e=>m(e.target.value),className:"hidden"})]},a.id))}),e.jsxs(t.div,{variants:h,className:"space-y-2",children:[e.jsx(i,{variant:"primary",size:"lg",fullWidth:!0,onClick:async()=>{if(c){g(!0);try{(await l.post("/auth/complete-welcome",{userRole:c})).data.success&&(n.success("Welcome complete! Let's get started."),d&&d(c,!0),o())}catch(e){n.error("Failed to save your preferences. Please try again.")}finally{g(!1)}}},disabled:!c||x,isLoading:x,className:"bg-primary hover:bg-primary/90 text-background disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-lg hover:shadow-xl transition-all",children:x?"Saving...":c?"Continue":"Select a role to continue"}),e.jsx("button",{onClick:o,disabled:x,className:"w-full py-3 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors rounded-lg hover:bg-muted/50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Skip for now"})]})]})]})]})})})})}function X(){const i=s(),[l,n]=r.useState([{id:"create_branch",title:"Create Your First Branch",description:"Set up a physical location or main campus to organize your members",completed:!1,estimatedTime:"1 min",action:()=>i("/branches")},{id:"create_group",title:"Add a Ministry Group",description:'Organize members by ministry, department, or team (e.g., "Sunday School", "Worship Team")',completed:!1,estimatedTime:"1 min",action:()=>i("/groups")},{id:"add_members",title:"Import Members",description:"Upload your contact list via CSV or add members manually",completed:!1,estimatedTime:"2 mins",action:()=>i("/members")},{id:"send_message",title:"Send Your First Message",description:"Try sending a test message to your first group and see instant delivery",completed:!1,estimatedTime:"2 mins",action:()=>i("/send-message")}]),[o,d]=r.useState(!0),c=l.filter(e=>e.completed).length,m=c/l.length*100;r.useEffect(()=>{const e=localStorage.getItem("onboarding_progress");if(e)try{n(JSON.parse(e))}catch(t){}},[]),r.useEffect(()=>{localStorage.setItem("onboarding_progress",JSON.stringify(l))},[l]);return o&&c!==l.length?e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white dark:bg-secondary-900 border border-gray-200 dark:border-secondary-700 rounded-2xl p-6 shadow-lg mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Get Started with YWMESSAGING"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Complete these steps to send your first message"})]}),e.jsx("button",{onClick:()=>d(!1),"aria-label":"Dismiss onboarding checklist",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-secondary-700 transition-colors",children:e.jsx(N,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:[c," of ",l.length," completed"]}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[Math.round(m),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-secondary-700 rounded-full h-2",children:e.jsx(t.div,{initial:{width:0},animate:{width:`${m}%`},transition:{duration:.5,ease:"easeOut"},className:"bg-blue-600 dark:bg-blue-500 h-2 rounded-full"})})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(a,{children:l.map((a,r)=>e.jsxs(t.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{delay:.1*r,duration:.3},className:`\n                flex items-start gap-3 p-4 rounded-lg border transition-colors\n                ${a.completed?"bg-green-50 dark:bg-green-500/10 border-green-200 dark:border-green-500/30":"bg-gray-50 dark:bg-secondary-800 border-gray-200 dark:border-secondary-700 hover:border-blue-300 dark:hover:border-blue-500/50 hover:bg-blue-50 dark:hover:bg-secondary-700/50"}\n              `,children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:a.completed?e.jsx(t.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},children:e.jsx(k,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}):e.jsx(C,{className:"w-6 h-6 text-gray-400 dark:text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h3",{className:"font-medium "+(a.completed?"text-green-900 dark:text-green-300":"text-gray-900 dark:text-white"),children:a.title}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 bg-white dark:bg-secondary-900 px-2 py-1 rounded-full",children:a.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.description})]}),!a.completed&&e.jsxs("button",{onClick:()=>{var e;a.action(),e=a.id,n(t=>t.map(t=>t.id===e?{...t,completed:!0}:t))},className:"flex-shrink-0 flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium text-sm px-3 py-2 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-500/20 transition-colors whitespace-nowrap",children:["Start",e.jsx(S,{className:"w-4 h-4"})]})]},a.id))})}),e.jsx(a,{children:c===l.length&&e.jsx(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},className:"mt-4 p-4 bg-green-50 dark:bg-green-500/10 border border-green-200 dark:border-green-500/30 rounded-lg",children:e.jsxs("p",{className:"text-green-900 dark:text-green-300 font-medium flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),"Congratulations! You're all set up. Start messaging your church today!"]})})})]}):null}function Z({deliveryRate:a=65,dlcStatus:r="pending"}){const i=s(),l="approved"===r,n="pending"===r||"shared_brand"===r;return e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"relative overflow-hidden rounded-2xl p-6 text-white",style:{background:l?"linear-gradient(135deg, #10b981 0%, #059669 100%)":"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)"},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute w-72 h-72 rounded-full blur-3xl",style:{background:"rgba(255, 255, 255, 0.1)",animation:"pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite",top:"-50%",right:"-50%"}})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90 font-medium",children:"Message Delivery Rate"}),e.jsxs("div",{className:"mt-2 flex items-baseline gap-2",children:[e.jsxs("p",{className:"text-4xl font-bold",children:[a,"%"]}),l&&e.jsx("span",{className:"text-sm bg-white/20 px-2 py-1 rounded-full",children:"Premium"})]})]}),e.jsx(t.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:e.jsx(L,{className:"w-8 h-8"})})]}),e.jsx("p",{className:"text-sm opacity-90 mb-6 max-w-xs",children:l?"Your messages reach church members with enterprise-grade reliability":"Upgrade to 10DLC registration for 99% delivery rate and faster message speeds"}),e.jsxs("div",{className:"flex gap-3",children:[n&&e.jsxs(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>i("/admin/settings"),className:"bg-white text-blue-600 px-4 py-2 rounded-lg font-medium text-sm hover:bg-gray-100 transition-colors flex items-center gap-2",children:["Upgrade to 99% Delivery",e.jsx(D,{className:"w-4 h-4"})]}),l&&e.jsxs(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:"bg-white/20 px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 backdrop-blur-sm border border-white/30",children:[e.jsx(k,{className:"w-5 h-5"}),"Enterprise Delivery Enabled"]})]}),e.jsxs(t.button,{whileHover:{x:4},onClick:()=>i("/admin/settings"),className:"mt-4 text-sm opacity-90 hover:opacity-100 transition-opacity flex items-center gap-1 group",children:["Learn more about 10DLC",e.jsx(D,{className:"w-3 h-3 group-hover:translate-x-1 transition-transform"})]})]})]})}const q=["#4A9FBF","#FFB81C","#98C26E","#505050"];function ee(){const{user:a,church:s}=o(),{branches:i,currentBranchId:l}=d(),[u,v]=r.useState(!0),[N,w]=r.useState(0),[k,C]=r.useState(0),[S,L]=r.useState(null),[D,V]=r.useState(null),[ee,te]=r.useState(!1),[ae,re]=r.useState(!1),[se,ie]=r.useState(!1),[le,ne]=r.useState(null);r.useEffect(()=>{const e=a?.welcomeCompleted;!e&&a&&te(!0)},[a]);const oe=r.useCallback((e,t)=>{if(a&&s){const{setAuth:r}=o.getState();r({...a,welcomeCompleted:t,userRole:e},s,o.getState().accessToken||"",o.getState().refreshToken||"")}se||re(!0)},[a,s,se]),de=r.useCallback(e=>{ie(!0),n.success("Phone number configured successfully!")},[]);r.useEffect(()=>{a&&(async()=>{try{await b(),ie(!0)}catch(e){ie(!1)}})()},[a]),r.useEffect(()=>{ce()},[l]);const ce=async()=>{try{v(!0);try{const e=await p();ne(e)}catch(e){}if(l){const e=await g(l);if(C(e.length),e.length>0){const t=await x(e[0].id,{limit:1});w(t.pagination.total)}}const t=await c();V(t);const a=await m({days:7});L(a)}catch(e){n.error("Failed to load dashboard data")}finally{v(!1)}},me=i.length,xe=D?.totalMessages||0,ge=S?.deliveryRate||0,ue=D?.totalGroups||0,pe=r.useMemo(()=>S?.byDay?S.byDay.map(e=>({name:new Date(e.date).toLocaleDateString("en-US",{weekday:"short"}),delivered:e.delivered,failed:e.failed})):[],[S?.byDay]),he=r.useMemo(()=>S?.byDay?S.byDay.map((e,t)=>({name:`Day ${t+1}`,sent:e.count,delivered:e.delivered})):[],[S?.byDay]),be=r.useMemo(()=>[{name:"Delivered",value:S?.deliveredCount||0},{name:"Failed",value:S?.failedCount||0},{name:"Pending",value:S?.pendingCount||0}],[S?.deliveredCount,S?.failedCount,S?.pendingCount]);return e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsx("div",{className:"mb-8",children:e.jsx(Q,{})}),e.jsx("div",{className:"mb-8",children:e.jsx(X,{})}),e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold text-foreground mb-2",children:["Welcome back, ",e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:a?.firstName})]}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:[s?.name," â€¢ ",(new Date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]}),le&&e.jsx(t.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:e.jsx(I,{dlcStatus:le.dlcStatus,deliveryRate:le.deliveryRate,wantsPremiumDelivery:le.wantsPremiumDelivery,variant:"badge"})})]}),"shared_brand"===le?.dlcStatus&&e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"mb-8 border-l-4 border-green-500 bg-green-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"ðŸš€ Ready for better SMS delivery?"}),e.jsx("p",{className:"text-xs text-gray-700 mt-1",children:"Upgrade to Premium 10DLC for 99% delivery rate. Visit your settings to enable it."})]}),e.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>window.location.hash="#/admin/settings",className:"text-xs font-semibold text-green-700 hover:text-green-800 whitespace-nowrap ml-4",children:"Upgrade â†’"})]})}),u?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx(t.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0},children:e.jsx(M,{className:"w-8 h-8 text-primary"})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(H,{icon:T,label:"Messages Sent",value:xe.toLocaleString(),change:12,changeType:"positive",gradient:"from-primary to-accent",index:0}),e.jsx(H,{icon:P,label:"Total Members",value:N.toLocaleString(),change:8,changeType:"positive",gradient:"from-green-500 to-emerald-500",index:1}),e.jsx(H,{icon:R,label:"Delivery Rate",value:`${ge.toFixed(1)}%`,change:-2,changeType:"negative",gradient:"from-purple-500 to-pink-500",index:2}),e.jsx(H,{icon:$,label:"Active Groups",value:ue.toString(),change:5,changeType:"positive",gradient:"from-orange-500 to-red-500",index:3})]}),le&&e.jsx("div",{className:"mb-8",children:e.jsx(Z,{deliveryRate:le.deliveryRate||ge,dlcStatus:le.dlcStatus})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(y,{variant:"gradient",index:0,children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-4",children:"Messages Overview"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Last 7 days delivery rate"}),pe.length>0?e.jsx(E,{width:"100%",height:300,children:e.jsxs(F,{data:pe,children:[e.jsx(B,{strokeDasharray:"3 3",stroke:"rgba(120,120,120,0.1)"}),e.jsx(W,{dataKey:"name",stroke:"rgba(120,120,120,0.5)"}),e.jsx(A,{stroke:"rgba(120,120,120,0.5)"}),e.jsx(_,{contentStyle:{backgroundColor:"rgba(20,20,30,0.95)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px"}}),e.jsx(O,{dataKey:"delivered",fill:q[0],radius:[8,8,0,0]}),e.jsx(O,{dataKey:"failed",fill:q[3],radius:[8,8,0,0]})]})}):e.jsx("div",{className:"h-80 flex items-center justify-center text-muted-foreground",children:"No data available"})]})}),e.jsx("div",{children:e.jsxs(y,{variant:"gradient",index:1,children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-4",children:"Message Status"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Distribution"}),be.some(e=>e.value>0)?e.jsx(E,{width:"100%",height:300,children:e.jsxs(z,{children:[e.jsx(U,{data:be,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",children:be.map((t,a)=>e.jsx(G,{fill:q[a%q.length]},`cell-${a}`))}),e.jsx(_,{contentStyle:{backgroundColor:"rgba(20,20,30,0.95)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px"}})]})}):e.jsx("div",{className:"h-80 flex items-center justify-center text-muted-foreground",children:"No data available"})]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(y,{variant:"gradient",index:2,children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-4",children:"Message Trends"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Sent vs Delivered over time"}),he.length>0?e.jsx(E,{width:"100%",height:350,children:e.jsxs(K,{data:he,children:[e.jsx(B,{strokeDasharray:"3 3",stroke:"rgba(120,120,120,0.1)"}),e.jsx(W,{dataKey:"name",stroke:"rgba(120,120,120,0.5)"}),e.jsx(A,{stroke:"rgba(120,120,120,0.5)"}),e.jsx(_,{contentStyle:{backgroundColor:"rgba(20,20,30,0.95)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px"}}),e.jsx(Y,{type:"monotone",dataKey:"sent",stroke:q[0],strokeWidth:3,dot:{fill:q[0],r:5}}),e.jsx(Y,{type:"monotone",dataKey:"delivered",stroke:q[1],strokeWidth:3,dot:{fill:q[1],r:5}})]})}):e.jsx("div",{className:"h-96 flex items-center justify-center text-muted-foreground",children:"No data available"})]})}),e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsxs(y,{variant:"default",index:3,children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-6",children:"Quick Stats"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Branches",value:me},{label:"Groups",value:ue},{label:"Members",value:N},{label:"Messages",value:xe}].map((a,r)=>e.jsxs(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*r},className:"p-4 rounded-xl bg-muted/50 border border-border/40 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2 font-medium",children:a.label}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:a.value})]},r))})]})})]})]})}),e.jsx(f,{variant:"floating",position:"bottom-right"}),e.jsx(J,{isOpen:ee,onClose:()=>te(!1),onWelcomeComplete:oe}),e.jsx(h,{isOpen:ae,onClose:()=>re(!1),onPurchaseComplete:de})]})}export{ee as DashboardPage,ee as default};
