import{j as e}from"./vendor-ui-DhbhiCKM.js";import{u as a,a as s,L as r}from"./vendor-react-DC7Nk3dg.js";import{u as t}from"./index.esm-C8Q_B5eL.js";import{u as o,f as l,C as i,I as m,B as d,_ as n,r as c}from"./index-CT9MgVV5.js";import{B as u}from"./BackButton-Coci-vNh.js";import{A as h}from"./AnimatedBlobs-CRLVUmpl.js";import"./vendor-utils-C8GUPZyx.js";function g(){const g=a(),{setAuth:x}=o(),[p,f]=s.useState(!1);s.useEffect(()=>{l().catch(()=>{})},[]);const{register:b,handleSubmit:N,watch:v,formState:w,trigger:j}=t({mode:"onChange",defaultValues:{email:"",password:"",confirmPassword:"",firstName:"",lastName:"",churchName:""}}),{errors:y}=w;v();return e.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 py-8 relative overflow-hidden",children:[e.jsx(h,{variant:"minimal"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-primary opacity-10 rounded-full blur-3xl pointer-events-none"}),e.jsxs("div",{className:"w-full max-w-2xl relative z-10 animate-fadeIn",children:[e.jsx("div",{className:"mb-6",children:e.jsx(u,{variant:"ghost",size:"sm"})}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("img",{src:"/logo.svg",alt:"Koinonia",className:"w-16 h-16 hover:opacity-80 transition-opacity"})}),e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-3 tracking-tight",children:"Create Your Account"}),e.jsx("p",{className:"text-lg text-muted-foreground font-light",children:"Start your 14-day free trial • No credit card required"})]}),e.jsxs(i,{variant:"default",className:"p-8 border border-border bg-card shadow-lg",children:[e.jsxs("form",{onSubmit:N(async e=>{if(!(await j())){const e=[];y.firstName&&e.push(`First name: ${y.firstName.message}`),y.lastName&&e.push(`Last name: ${y.lastName.message}`),y.churchName&&e.push(`Church name: ${y.churchName.message}`),y.email&&e.push(`Email: ${y.email.message}`),y.password&&e.push(`Password: ${y.password.message}`),y.confirmPassword&&e.push(`Confirm password: ${y.confirmPassword.message}`);const a=e.length>0?e.join("\n"):"Please check your form for errors";return void n.error(a)}if(e.password===e.confirmPassword){f(!0);try{const a=await c({email:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName,churchName:e.churchName}),{admin:s,church:r,accessToken:t,refreshToken:o}=a.data;if(!(s&&r&&t&&o))return n.error("Invalid registration response. Please try again."),void f(!1);x(s,r,t,o),g("/dashboard",{replace:!0}),n.success("Registration successful!")}catch(a){if(f(!1),429===a.response?.status){const e=a.response?.headers?.["ratelimit-reset"];if(e){const a=1e3*parseInt(e),s=Date.now(),r=Math.ceil((a-s)/1e3),t=Math.ceil(r/60),o=`Too many registration attempts. Please try again in ${t} minute${t>1?"s":""}.`;n.error(o,{duration:5e3})}else n.error("Too many registration attempts. Please try again in 1 hour.")}else{const e=a.response?.data?.error||"Registration failed. Please try again.";n.error(e)}}}else n.error("Passwords do not match")}),className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(m,{label:"First Name",placeholder:"John",disabled:p,error:y.firstName?.message,autoComplete:"given-name",className:"bg-muted border-border text-foreground",...b("firstName",{required:"First name is required",maxLength:{value:100,message:"First name is too long (max 100 characters)"}})}),e.jsx(m,{label:"Last Name",placeholder:"Doe",disabled:p,error:y.lastName?.message,autoComplete:"family-name",className:"bg-muted border-border text-foreground",...b("lastName",{required:"Last name is required",maxLength:{value:100,message:"Last name is too long (max 100 characters)"}})})]}),e.jsx(m,{label:"Church Name",placeholder:"Grace Community Church",disabled:p,error:y.churchName?.message,autoComplete:"organization",className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...b("churchName",{required:"Church name is required",maxLength:{value:255,message:"Church name is too long (max 255 characters)"}})}),e.jsx(m,{label:"Email Address",type:"email",placeholder:"pastor@church.com",disabled:p,error:y.email?.message,autoComplete:"email",className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...b("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"},maxLength:{value:255,message:"Email is too long (max 255 characters)"}})}),e.jsx(m,{label:"Password",type:"password",placeholder:"••••••••",helperText:"At least 8 characters, 1 uppercase letter, 1 number",disabled:p,error:y.password?.message,autoComplete:"new-password",className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...b("password",{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"},validate:{hasUppercase:e=>/[A-Z]/.test(e)||"Password must contain at least one uppercase letter",hasNumber:e=>/[0-9]/.test(e)||"Password must contain at least one number"}})}),e.jsx(m,{label:"Confirm Password",type:"password",placeholder:"••••••••",disabled:p,error:y.confirmPassword?.message,autoComplete:"new-password",className:"bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",...b("confirmPassword",{required:"Please confirm your password"})}),e.jsx(d,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,isLoading:p,disabled:p,className:"font-semibold mt-6 bg-primary hover:bg-primary/90 text-background",children:p?"Creating account...":"Create Account"})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-border",children:e.jsxs("p",{className:"text-center text-muted-foreground text-sm",children:["Already have an account?"," ",e.jsx(r,{to:"/login",className:"text-primary hover:text-primary/80 font-semibold transition-colors",children:"Login here"})]})})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-success-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"Setup in Minutes"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-success-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"Secure & Reliable"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-success-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"No Card Required"})]})]})]})]})}export{g as RegisterPage,g as default};
