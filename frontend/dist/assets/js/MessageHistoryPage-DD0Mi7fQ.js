import{j as e,m as t}from"./vendor-ui-DmDBw7yB.js";import{a as s}from"./vendor-react-GajVb7Yi.js";import{_ as a}from"./index-CS2dyVAP.js";import{u as i,g as r}from"./messages-DFWM2ThK.js";import{a as n,S as l}from"./SoftLayout-ZzILyjWn.js";import{S as o}from"./SoftButton-BT31kdh0.js";import{M as d}from"./MobileTable-D0LwGODm.js";import{o as c,L as m,H as x,p as u,i as p}from"./vendor-utils-DLLPIWmj.js";import"./useBreakpoint-D_gF-sG6.js";import"./designTokens-BhFJIg83.js";function g(){const{messages:g,setMessages:h,isLoading:j,setLoading:y}=i(),[f,b]=s.useState(1),[v,N]=s.useState(0),[w,S]=s.useState(""),k=Math.ceil(v/20);s.useEffect(()=>{M()},[f,w]);const M=async()=>{try{y(!0);const e=await r({page:f,limit:20,status:w||void 0});h(e.data),N(e.pagination.total)}catch(e){a.error(e.message||"Failed to load messages")}finally{y(!1)}},C=e=>{switch(e){case"sent":return"bg-green-500/20 text-green-400";case"pending":return"bg-yellow-500/20 text-yellow-400";case"failed":return"bg-red-500/20 text-red-400";default:return"bg-slate-700/50 text-slate-300"}};return e.jsx(n,{children:e.jsxs("div",{className:"px-4 md:px-8 py-8 w-full",children:[e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:e.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Message History"})}),e.jsxs("p",{className:"text-muted-foreground",children:[v," total messages"]})]}),e.jsx(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(l,{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-semibold text-foreground mb-3 flex items-center gap-2",children:[e.jsx(c,{className:"w-4 h-4"}),"Filter by Status"]}),e.jsxs("select",{value:w,onChange:e=>{S(e.target.value),b(1)},className:"px-4 py-2 border border-border/40 rounded-lg bg-card/50 text-foreground focus:outline-none focus:ring-2 focus:ring-primary transition-colors duration-normal backdrop-blur-sm",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"failed",children:"Failed"})]})]})}),j?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(t.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:e.jsx(m,{className:"w-8 h-8 text-primary"})})}):0===g.length?e.jsx(t.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2},children:e.jsxs(l,{variant:"gradient",className:"text-center py-16",children:[e.jsx("div",{className:"mb-6",children:e.jsx(x,{className:"w-16 h-16 mx-auto text-muted-foreground"})}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"No Messages Found"}),e.jsx("p",{className:"text-muted-foreground",children:"Your message history will appear here after you send messages."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},children:e.jsx(l,{className:"overflow-hidden",children:e.jsx(d,{data:g,columns:[{label:"Message",key:"content",render:t=>e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-foreground font-medium",children:[t.content.slice(0,50),t.content.length>50?"...":""]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"individual"===t.targetType?"Individual":"branches"===t.targetType?"Branches":"All Members"})]})},{label:"Recipients",key:"totalRecipients",render:t=>e.jsx("div",{className:"text-sm text-foreground font-medium",children:t.totalRecipients})},{label:"Delivery",key:"deliveredCount",render:t=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{className:"text-foreground font-medium",children:[t.deliveredCount,"/",t.totalRecipients]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:[t.deliveryRate||0,"%"]})]})},{label:"Status",key:"status",render:t=>e.jsx("span",{className:`inline-block px-3 py-1 text-xs font-semibold rounded-full ${C(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})},{label:"Sent",key:"createdAt",render:t=>e.jsxs("div",{className:"text-sm text-muted-foreground",children:[new Date(t.createdAt).toLocaleDateString(),e.jsx("br",{}),new Date(t.createdAt).toLocaleTimeString()]})}],keyField:"id"})})}),k>1&&e.jsxs(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-6 flex justify-center gap-2",children:[e.jsx(o,{variant:"secondary",size:"md",onClick:()=>b(Math.max(1,f-1)),disabled:1===f,icon:e.jsx(u,{className:"w-4 h-4"}),children:"Previous"}),e.jsxs("div",{className:"px-4 py-2 text-muted-foreground font-medium",children:["Page ",f," of ",k]}),e.jsx(o,{variant:"secondary",size:"md",onClick:()=>b(Math.min(k,f+1)),disabled:f===k,icon:e.jsx(p,{className:"w-4 h-4"}),children:"Next"})]})]})]})})}export{g as MessageHistoryPage,g as default};
